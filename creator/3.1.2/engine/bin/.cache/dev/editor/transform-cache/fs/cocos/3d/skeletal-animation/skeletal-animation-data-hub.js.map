{"version":3,"sources":["file:///Users/mac/jenkins/workspace/Creator_3D/daily_build_mac/resources/3d/engine/cocos/3d/skeletal-animation/skeletal-animation-data-hub.ts"],"names":["SkelAnimDataHub","getOrExtract","clip","data","pool","get","info","sample","legacyCC","director","root","dataPoolManager","releaseAnimationClip","convertToSkeletalCurves","set","destroy","delete","Map","curves","forEach","curve","valueAdapter","modifiers","HierarchyPath","path","cs","property","values","keys","frames","Math","ceil","duration","Object","props","defineProperty","_worldMatrix","position","rotation","scale","convertToUniformSample","convertToWorldSpace","length","i","clone","isQuat","Quat","idx","time","from","denom","ratio","slerp","lerp","convertedProps","oPos","oRot","oScale","matrix","map","Mat4","lastIndexOf","pMatrix","name","substring","console","warn","worldMatrix","oT","oR","oS","m","fromRTS","multiply","k","interpolate"],"mappings":"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"}