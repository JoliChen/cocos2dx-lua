{"version":3,"sources":["file:///Users/mac/jenkins/workspace/Creator_3D/daily_build_mac/resources/3d/engine/cocos/physics/cocos/builtin-world.ts"],"names":["hitPoint","Vec3","TriggerEventObject","type","selfCollider","otherCollider","impl","BuiltInWorld","shapeArr","bodies","_shapeArrPrev","_collisionMatrix","ArrayCollisionMatrix","_collisionMatrixPrev","setGravity","v","setAllowSleep","setDefaultMaterial","destroy","length","step","deltaTime","tmp","i","bodyA","j","bodyB","collisionFilterGroup","collisionFilterMask","intersects","syncSceneToPhysics","syncAfterEvents","emitEvents","emitTriggerEvent","raycastClosest","worldRay","options","out","tmp_d","Infinity","max_d","maxDistance","mask","body","shapes","shape","distance","intersect","resolve","worldShape","normalize","d","scaleAndAdd","o","_assign","collider","ZERO","raycast","pool","results","r","add","computeHit","push","getSharedBody","node","wrappedBody","BuiltinSharedBody","addSharedBody","index","indexOf","removeSharedBody","shapeA","shapeB","set","id","get","emit","temp","matrix","reset"],"mappings":"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"}