{"version":3,"sources":["file:///Users/mac/jenkins/workspace/Creator_3D/daily_build_mac/resources/3d/engine/cocos/core/renderer/scene/model.ts"],"names":["AttrPool","ObjectPool","PoolType","ATTRIBUTE","_","obj","Attribute","m4_1","Mat4","_subModelPool","Pool","SubModel","shadowMapPatches","name","value","ModelType","uploadMat4AsVec4x3","mat","v1","v2","v3","m00","m01","m02","m12","m04","m05","m06","m13","m08","m09","m10","m14","lightmapSamplerHash","Filter","LINEAR","NONE","Address","CLAMP","lightmapSamplerWithMipHash","Model","subModels","_subModels","inited","_inited","worldBounds","_worldBounds","modelBounds","_modelBounds","localBuffer","_localBuffer","updateStamp","_updateStamp","isInstancingEnabled","_instMatWorldIdx","receiveShadow","ModelPool","get","_handle","ModelView","RECEIVE_SHADOW","val","set","onMacroPatchesStateChanged","castShadow","CAST_SHADOW","handle","node","_node","n","NODE","transform","_transform","TRANSFORM","visFlags","_visFlags","VIS_FLAGS","enabled","_enabled","ENABLED","constructor","type","DEFAULT","scene","isDynamicBatching","instancedAttributes","buffer","views","attributes","Layers","Enum","_device","_descriptorSetCount","_transformUpdated","NULL_HANDLE","_hWorldBounds","_localData","Float32Array","UBOLocal","COUNT","_lightmap","_lightmapUVParam","Vec4","legacyCC","director","root","device","initialize","alloc","hSubModelArray","SubModelArrayPool","hInstancedAttrArray","AttributeArrayPool","INSTANCED_ATTR_ARRAY","SUB_MODEL_ARRAY","destroy","i","length","subModel","free","hOldBuffer","INSTANCED_BUFFER","RawBufferPool","hAttrArray","AABBPool","attachToScene","detachFromScene","updateTransform","stamp","hasChangedFlags","_dirtyFlags","updateWorldTransform","_mat","_pos","_rot","_scale","setVec3","AABBView","CENTER","center","HALF_EXTENSION","halfExtents","updateWorldBound","updateUBOs","update","worldMatrix","idx","attrs","toArray","MAT_WORLD_OFFSET","inverseTranspose","MAT_WORLD_IT_OFFSET","createBoundingShape","minPos","maxPos","AABB","fromPoints","create","clone","WORLD_BOUNDS","initSubModel","subMeshData","isNewSubModel","passes","getMacroPatches","initPlanarShadowShader","initPlanarShadowInstanceShader","_updateAttributesAndBinding","assign","setSubModelMesh","subMesh","setSubModelMaterial","onGlobalPipelineStateChanged","onPipelineStateChanged","updateLightingmap","texture","uvParam","LIGHTINGMAP_UVPARAM","builtinResMgr","gfxTexture","getGFXTexture","sampler","samplerLib","getSampler","mipmaps","descriptorSet","bindTexture","UNIFORM_LIGHTMAP_TEXTURE_BINDING","bindSampler","subModelIndex","_initLocalDescriptors","_updateLocalDescriptors","shader","ShaderPool","SubModelPool","SubModelView","SHADER_0","_updateInstancedAttributes","_getInstancedAttributeIndex","pass","hasFeature","Feature","INSTANCED_ARRAYS","size","j","attribute","isInstanced","FormatInfos","format","hBuffer","getBuffer","Uint8Array","offset","hAttr","attr","isNormalized","location","push","info","count","batchingScheme","BatchingSchemes","INSTANCING","InstancedBuffer","INST_MAT_WORLD","createBuffer","BufferInfo","BufferUsageBit","UNIFORM","TRANSFER_DST","MemoryUsageBit","HOST","DEVICE","SIZE","bindBuffer","BINDING"],"mappings":"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"}