{"version":3,"sources":["file:///Users/mac/jenkins/workspace/Creator_3D/daily_build_mac/resources/3d/engine/cocos/core/pipeline/forward/forward-pipeline.ts"],"names":["_samplerInfo","Filter","POINT","NONE","Address","CLAMP","ForwardPipeline","RenderTextureConfig","MaterialConfig","RenderPipeline","_renderPasses","Map","initialize","info","_flows","length","shadowFlow","ShadowFlow","initInfo","push","forwardFlow","ForwardFlow","activate","_activeRenderer","render","cameras","_commandBuffers","begin","_pipelineUBO","updateGlobalUBO","i","camera","scene","updateCameraUBO","j","end","_device","flushCommands","queue","submit","getRenderPass","clearFlags","renderPass","get","device","colorAttachment","ColorAttachment","depthStencilAttachment","DepthStencilAttachment","format","colorFormat","depthStencilFormat","stencilStoreOp","StoreOp","DISCARD","depthStoreOp","ClearFlagBit","COLOR","SKYBOX_FLAG","loadOp","LoadOp","LOAD","beginAccesses","AccessType","PRESENT","DEPTH_STENCIL","DEPTH","depthLoadOp","STENCIL","stencilLoadOp","DEPTH_STENCIL_ATTACHMENT_WRITE","renderPassInfo","RenderPassInfo","createRenderPass","set","commandBuffer","shadowMapSamplerHash","shadowMapSampler","samplerLib","getSampler","_descriptorSet","bindSampler","UNIFORM_SHADOWMAP_BINDING","bindTexture","builtinResMgr","getGFXTexture","UNIFORM_SPOT_LIGHTING_MAP_TEXTURE_BINDING","update","destroyUBOs","getBuffer","UBOGlobal","BINDING","destroy","UBOShadow","UBOCamera","getTexture","rpIter","values","rpRes","next","done","value","serializable"],"mappings":"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"}