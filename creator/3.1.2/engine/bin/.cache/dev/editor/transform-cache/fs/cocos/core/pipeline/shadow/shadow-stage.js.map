{"version":3,"sources":["file:///Users/mac/jenkins/workspace/Creator_3D/daily_build_mac/resources/3d/engine/cocos/core/pipeline/shadow/shadow-stage.ts"],"names":["colors","Color","ShadowStage","RenderStage","_shadowFrameBuffer","_renderArea","Rect","_light","setUsage","light","shadowFrameBuffer","destroy","_additiveShadowQueue","clear","clearFramebuffer","camera","w","clearColor","pipeline","_pipeline","cmdBuff","commandBuffers","renderPass","beginRenderPass","clearDepth","clearStencil","endRenderPass","render","pipelineSceneData","shadowInfo","shadows","shadingScale","gatherLightPasses","vp","viewport","shadowMapSize","size","x","y","width","height","device","bindDescriptorSet","SetIndex","GLOBAL","descriptorSet","recordCommandBuffer","activate","flow","RenderShadowMapBatchedQueue","initInfo","name","priority","ForwardStagePriority","FORWARD","tag"],"mappings":"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"}