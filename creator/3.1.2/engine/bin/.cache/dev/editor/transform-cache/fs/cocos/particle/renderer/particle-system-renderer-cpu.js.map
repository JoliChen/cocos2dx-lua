{"version":3,"sources":["file:///Users/mac/jenkins/workspace/Creator_3D/daily_build_mac/resources/3d/engine/cocos/particle/renderer/particle-system-renderer-cpu.ts"],"names":["_tempAttribUV","Vec3","_tempWorldTrans","Mat4","_anim_module","_uvs","CC_USE_WORLD_SPACE","CC_RENDER_MODE","RENDER_MODE_BILLBOARD","RENDER_MODE_STRETCHED_BILLBOARD","RENDER_MODE_HORIZONTAL_BILLBOARD","RENDER_MODE_VERTICAL_BILLBOARD","RENDER_MODE_MESH","_vertex_attrs","Attribute","AttributeName","ATTR_POSITION","Format","RGB32F","ATTR_TEX_COORD","ATTR_TEX_COORD1","ATTR_TEX_COORD2","ATTR_COLOR","RGBA8","_vertex_attrs_stretch","ATTR_COLOR1","_vertex_attrs_mesh","ATTR_TEX_COORD3","ATTR_NORMAL","_matInsInfo","parent","owner","subModelIdx","ParticleSystemRendererCPU","ParticleSystemRendererBase","constructor","info","_defines","_trailDefines","_frameTile_velLenScale","_defaultMat","_node_scale","_attrs","_particles","_defaultTrailMat","_updateList","Map","_animateList","_runAnimateList","Array","_fillDataFunc","_uScaleHandle","_uLenHandle","_inited","_localMat","_gravity","Vec4","_model","CC_USE_BILLBOARD","CC_USE_STRETCHED_BILLBOARD","CC_USE_HORIZONTAL_BILLBOARD","CC_USE_VERTICAL_BILLBOARD","onInit","ps","RecyclePool","Particle","_setVertexAttrib","_setFillFunc","_initModuleList","_initModel","updateMaterialParams","updateTrailMaterial","setVertexAttributes","clear","reset","_particleSystem","_trailModule","updateRenderData","enabled","updateRenderMode","getFreeParticle","length","capacity","add","getDefaultTrailMaterial","setNewParticle","p","forEach","val","pm","enable","needUpdate","name","needAnimate","i","len","PARTICLE_MODULE_ORDER","push","enableModule","updateParticles","dt","node","getWorldMatrix","scaleSpace","Space","Local","getScale","World","getWorldScale","mat","getMaterialInstance","pass","passes","setUniform","value","key","update","_simulationSpace","trailModule","trailEnable","simulationSpace","r","getRotation","fromQuat","transpose","data","remainingLifetime","set","animatedVelocity","removeParticle","removeAt","gravityFactor","gravityModifier","evaluate","startLifetime","randomSeed","x","y","z","w","transformMat4","velocity","copy","ultimateVelocity","animate","scaleAndAdd","position","idx","fi","textureModule","_textureAnimationModule","frameIndex","beforeRender","updateIA","getParticleCount","onMaterialModified","index","material","onRebuildPSO","setSubModelMaterial","_trailModel","_renderInfo","renderMode","RenderMode","Mesh","_fillMeshData","StrecthedBillboard","_fillStrecthedData","_fillNormalData","attrNum","size","rotation","color","_val","addParticleVertexData","j","_vertAttrs","slice","shareMaterial","sharedMaterial","effectName","_effectAsset","_name","mainTexture","getProperty","indexOf","setMaterial","builtinResMgr","get","MaterialInstance","setProperty","getHandle","vlenScale","Billboard","velocityScale","lengthScale","HorizontalBillboard","VerticalBillboard","console","warn","Vec2","numTilesX","numTilesY","recompileShaders","updateMaterial","space"],"mappings":"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"}