{"version":3,"sources":["file:///Users/mac/jenkins/workspace/Creator_3D/daily_build_mac/resources/3d/engine/cocos/2d/renderer/mesh-buffer.ts"],"names":["MeshBuffer","attributes","_attributes","vertexBuffers","_vertexBuffers","indexBuffer","_indexBuffer","constructor","batcher","vData","iData","byteStart","byteOffset","indicesStart","indicesOffset","vertexStart","vertexOffset","lastByteOffset","_iaInfo","_batcher","_dirty","_vertexFormatBytes","_initVDataCount","_initIDataCount","_outOfCallback","_hInputAssemblers","_nextFreeIAHandle","vertexFormatBytes","initialize","attrs","outOfCallback","formatBytes","Float32Array","BYTES_PER_ELEMENT","vbStride","length","push","device","createBuffer","BufferInfo","BufferUsageBit","VERTEX","TRANSFER_DST","MemoryUsageBit","HOST","DEVICE","ibStride","Uint16Array","INDEX","InputAssemblerInfo","_reallocBuffer","request","vertexCount","indicesCount","call","byteLength","indicesLength","reset","destroy","i","IAPool","free","recordBatch","vCount","NULL_HANDLE","alloc","hIA","ia","get","firstIndex","indexCount","uploadBuffers","verticesData","buffer","indicesData","size","resize","update","_reallocVData","_reallocIData","copyOldData","oldVData","Uint8Array","newData","l","oldIData","OPACITY_OFFSET"],"mappings":"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"}