{"version":3,"sources":["file:///Users/mac/jenkins/workspace/Creator_3D/daily_build_mac/resources/3d/engine/cocos/core/pipeline/pipeline-ubo.ts"],"names":["matShadowView","Mat4","matShadowViewProj","vec3_center","Vec3","vec4ShadowInfo","Vec4","PipelineUBO","_globalUBO","Float32Array","UBOGlobal","COUNT","_cameraUBO","UBOCamera","_shadowUBO","UBOShadow","updateGlobalUBOView","pipeline","bufferView","device","root","legacyCC","director","fv","shadingWidth","Math","floor","width","shadingHeight","height","TIME_OFFSET","cumulativeTime","frameTime","getTotalFrames","SCREEN_SIZE_OFFSET","NATIVE_SIZE_OFFSET","updateCameraUBOView","camera","scene","getScene","renderScene","mainLight","sceneData","pipelineSceneData","ambient","fog","cv","exposure","isHDR","shadingScale","fpScale","SCREEN_SCALE_OFFSET","EXPOSURE_OFFSET","toArray","direction","MAIN_LIT_DIR_OFFSET","color","MAIN_LIT_COLOR_OFFSET","useColorTemperature","colorTempRGB","colorTemperatureRGB","x","y","z","illuminance","UNIT_Z","ZERO","skyColor","colorArray","skyIllum","set","AMBIENT_SKY_OFFSET","albedoArray","AMBIENT_GROUND_OFFSET","matView","MAT_VIEW_OFFSET","node","worldMatrix","MAT_VIEW_INV_OFFSET","position","CAMERA_POS_OFFSET","matProj","MAT_PROJ_OFFSET","matProjInv","MAT_PROJ_INV_OFFSET","matViewProj","MAT_VIEW_PROJ_OFFSET","matViewProjInv","MAT_VIEW_PROJ_INV_OFFSET","getCombineSignY","GLOBAL_FOG_COLOR_OFFSET","GLOBAL_FOG_BASE_OFFSET","fogStart","fogEnd","fogDensity","GLOBAL_FOG_ADD_OFFSET","fogTop","fogRange","fogAtten","updateShadowUBOView","shadowInfo","shadows","sv","enabled","type","ShadowType","ShadowMap","shadowCameraView","far","autoAdapt","getWorldRotation","radius","sphere","aspect","halfFar","distance","center","min","Shadows","COEFFICIENT_OF_EXPANSION","MAX_FAR","getWorldMatrix","orthoSize","MAT_LIGHT_VIEW_OFFSET","invert","ortho","near","capabilities","clipSpaceMinZ","clipSpaceSignY","multiply","MAT_LIGHT_VIEW_PROJ_OFFSET","isSupportHalfFloat","linear","SHADOW_NEAR_FAR_LINEAR_SELF_INFO_OFFSET","selfShadow","SHADOW_WIDTH_HEIGHT_PCF_BIAS_INFO_OFFSET","size","pcf","bias","packing","SHADOW_LIGHT_PACKING_NBIAS_NULL_INFO_OFFSET","normalBias","Planar","Color","shadowColor","SHADOW_COLOR_OFFSET","updateShadowUBOLightView","light","_x","_y","_far","LightType","DIRECTIONAL","update","SPOT","range","perspective","spotAngle","_combineSignY","_initCombineSignY","_device","screenSpaceSignY","activate","_pipeline","ds","descriptorSet","globalUBO","createBuffer","BufferInfo","BufferUsageBit","UNIFORM","TRANSFER_DST","MemoryUsageBit","HOST","DEVICE","SIZE","bindBuffer","BINDING","cameraUBO","shadowUBO","updateGlobalUBO","globalDSManager","cmdBuffer","commandBuffers","updateBuffer","getBuffer","updateCameraUBO","updateShadowUBO","shadowFrameBufferMap","has","bindTexture","UNIFORM_SHADOWMAP_BINDING","get","colorTextures","updateShadowUBOLight","updateShadowUBORange","offset","data","destroy"],"mappings":"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"}