{"version":3,"sources":["file:///Users/mac/jenkins/workspace/Creator_3D/daily_build_mac/resources/3d/engine/cocos/particle/renderer/particle-system-renderer-gpu.ts"],"names":["_tempWorldTrans","Mat4","_tempVec4","Vec4","_world_rot","Quat","_sample_num","_sample_interval","CC_USE_WORLD_SPACE","CC_RENDER_MODE","RENDER_MODE_BILLBOARD","RENDER_MODE_STRETCHED_BILLBOARD","RENDER_MODE_HORIZONTAL_BILLBOARD","RENDER_MODE_VERTICAL_BILLBOARD","RENDER_MODE_MESH","COLOR_OVER_TIME_MODULE_ENABLE","ROTATION_OVER_TIME_MODULE_ENABLE","SIZE_OVER_TIME_MODULE_ENABLE","VELOCITY_OVER_TIME_MODULE_ENABLE","FORCE_OVER_TIME_MODULE_ENABLE","TEXTURE_ANIMATION_MODULE_ENABLE","_vert_attr_name","POSITION_STARTTIME","VERT_SIZE_UV","VERT_ROTATION_UV","COLOR","DIR_LIFE","RANDOM_SEED","_gpu_vert_attr","Attribute","Format","RGBA32F","R32F","_gpu_vert_attr_mesh","AttributeName","ATTR_TEX_COORD","RGB32F","ATTR_TEX_COORD3","ATTR_NORMAL","ATTR_COLOR1","RGBA8","_matInsInfo","parent","owner","subModelIdx","ParticleSystemRendererGPU","ParticleSystemRendererBase","constructor","info","_defines","_frameTile_velLenScale","_node_scale","_vertAttrs","_defaultMat","_particleNum","_tempParticle","_colorTexture","_forceTexture","_velocityTexture","_rotationTexture","_sizeTexture","_animTexture","_uTimeHandle","_uRotHandle","_inited","CC_USE_BILLBOARD","CC_USE_STRETCHED_BILLBOARD","CC_USE_HORIZONTAL_BILLBOARD","CC_USE_VERTICAL_BILLBOARD","Particle","onInit","ps","_setVertexAttrib","_initModel","updateMaterialParams","setVertexAttributes","updateRenderMode","_model","constructAttributeIndex","clear","updateRenderData","onDestroy","destroy","enableModule","name","val","pm","mat","_particleSystem","getMaterialInstance","initShaderUniform","recompileShaders","setSubModelMaterial","getFreeParticle","_capacity","setNewParticle","p","addGPUParticleVertexData","_time","updateParticles","dt","EDITOR","node","getWorldMatrix","scaleSpace","Space","Local","getScale","World","getWorldScale","updateGPUParticles","updateShaderUniform","enabled","beforeRender","updateIA","pass","passes","x","y","setUniform","getWorldRotation","getHandle","enable","forceModule","_forceOvertimeModule","z","handle","binding","Pass","getBindingFromHandle","bindSampler","getGFXSampler","bindTexture","getGFXTexture","spaceHandle","space","modeHandle","height","velocityModule","_velocityOvertimeModule","speedModifier","colorModule","_colorOverLifetimeModule","color","roationModule","_rotationOvertimeModule","separateAxes","sizeModule","_sizeOvertimeModule","size","textureModule","_textureAnimationModule","startFrame","frameOverTime","infoHandle","numTilesX","numTilesY","cycleCount","getParticleCount","onMaterialModified","index","material","onRebuildPSO","_renderInfo","renderMode","RenderMode","StrecthedBillboard","slice","Mesh","shareMaterial","sharedMaterial","effectName","_effectAsset","_name","mainTexture","getProperty","indexOf","setMaterial","builtinResMgr","get","MaterialInstance","setProperty","_simulationSpace","Billboard","velocityScale","w","lengthScale","HorizontalBillboard","VerticalBillboard","console","warn","Vec2","set","updateMaterial"],"mappings":"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"}