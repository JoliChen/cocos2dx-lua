{"version":3,"sources":["file:///Users/mac/jenkins/workspace/Creator_3D/daily_build_mac/resources/3d/engine/cocos/3d/skeletal-animation/skeletal-animation.ts"],"names":["Socket","Node","constructor","path","target","serializable","editable","js","setClassAlias","m4_1","Mat4","m4_2","collectRecursively","node","prefix","out","i","children","length","child","name","push","SkeletalAnimation","executeInEditMode","Animation","sockets","_sockets","val","_useBakedAnimation","animMgr","legacyCC","director","getAnimationManager","removeSockets","addSockets","rebuildSocketAnimations","useBakedAnimation","comps","getComponentsInChildren","SkinnedMeshRenderer","comp","skinningRoot","setUseBakedAnimation","onDestroy","root","dataPoolManager","jointAnimationInfo","destroy","uuid","start","querySockets","animPaths","_defaultClip","Object","keys","SkelAnimDataHub","getOrExtract","data","sort","reduce","acc","cur","startsWith","getChildByPath","socket","joint","substring","lastIndexOf","parent","fromRTS","rotation","position","scale","equals","matrix","stateName","_nameToState","state","rebuildSocketCurves","createSocket","find","s","console","warn","_createState","clip","SkeletalAnimationState","_doCreateState"],"mappings":"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"}