{"version":3,"sources":["file:///Users/mac/jenkins/workspace/Creator_3D/daily_build_mac/resources/3d/engine/cocos/core/renderer/core/render-window.ts"],"names":["RenderWindow","width","_width","height","_height","framebuffer","FramebufferPool","get","RenderWindowPool","_poolHandle","RenderWindowView","FRAMEBUFFER","shouldSyncSizeWithSwapchain","_shouldSyncSizeWithSwapchain","hasOnScreenAttachments","HAS_ON_SCREEN_ATTACHMENTS","hasOffScreenAttachments","HAS_OFF_SCREEN_ATTACHMENTS","handle","cameras","_cameras","registerCreateFunc","root","_createWindowFun","_root","constructor","_title","_nativeWidth","_nativeHeight","_renderPass","_colorTextures","_depthStencilTexture","_swapchainBufferIndices","NULL_HANDLE","initialize","device","info","alloc","title","undefined","swapchainBufferIndices","colorAttachments","depthStencilAttachment","renderPassInfo","i","length","format","Format","UNKNOWN","colorFormat","depthStencilFormat","createRenderPass","colorTex","createTexture","TextureInfo","TextureType","TEX2D","TextureUsageBit","COLOR_ATTACHMENT","SAMPLED","set","push","DEPTH_STENCIL_ATTACHMENT","hFBO","FramebufferInfo","destroy","clearCameras","colorTexture","resize","needRebuild","camera","isWindowSize","extractRenderCameras","j","enabled","update","attachCamera","sortCameras","detachCamera","splice","sort","a","b","priority"],"mappings":"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"}