{"version":3,"sources":["file:///Users/mac/jenkins/workspace/Creator_3D/daily_build_mac/resources/3d/engine/cocos/3d/skeletal-animation/skeletal-animation-state.ts"],"names":["m4_1","Mat4","m4_2","noCurves","SkeletalAnimationState","AnimationState","constructor","clip","name","_frames","_bakedDuration","_animInfo","_sockets","_animInfoMgr","_comps","_parent","_curvesInited","legacyCC","director","root","dataPoolManager","jointAnimationInfo","initialize","_curveLoaded","length","comps","getComponentsInChildren","SkinnedMeshRenderer","i","comp","skinningRoot","push","getComponent","baked","useBakedAnimation","undefined","info","SkelAnimDataHub","getOrExtract","frames","getData","uuid","sample","onPlay","_sampleCurves","_sampleCurvesBaked","duration","switchClip","uploadAnimation","_targetNode","rebuildSocketCurves","sockets","socket","targetNode","getChildByPath","path","target","clipData","animPath","source","data","animNode","downstream","idx","lastIndexOf","substring","identity","fromRTS","rotation","position","scale","multiply","parent","curveData","worldMatrix","values","transforms","f","mat","IDENTITY","tfm","pos","Vec3","rot","Quat","toRTS","ratio","curFrame","dirty","setRTS"],"mappings":"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"}