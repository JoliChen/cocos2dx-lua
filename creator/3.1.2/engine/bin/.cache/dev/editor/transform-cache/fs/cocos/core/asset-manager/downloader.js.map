{"version":3,"sources":["file:///Users/mac/jenkins/workspace/Creator_3D/daily_build_mac/resources/3d/engine/cocos/core/asset-manager/downloader.ts"],"names":["REGEX","downloadImage","url","options","onComplete","func","sys","capabilities","imageBitmap","legacyCC","assetManager","allowImageBitmap","downloadBlob","downloadDomImage","xhrResponseType","onFileProgress","downloadJson","downloadArrayBuffer","downloadText","downloadBundle","nameOrUrl","bundleName","test","downloader","remoteBundles","indexOf","remoteServerAddress","version","bundleVers","count","config","out","error","err","response","base","jspath","Downloader","maxConcurrency","maxRequestsPerFrame","maxRetryCount","BUILD","appendTimeStamp","EDITOR","limited","retryInterval","downloadDomAudio","downloadFile","downloadScript","_downloaders","bundle","default","_downloading","Cache","_queue","_queueDirty","_totalNum","_totalNumThisPeriod","_lastDate","_checkNextPeriod","_remoteServerAddress","_maxInterval","init","clear","length","register","type","handler","js","mixin","download","id","file","files","get","downloadCallbacks","push","request","find","x","priority","process","index","callback","add","_updateTime","done","data","_handleQueueInNextFrame","finale","result","callbacks","remove","i","l","loadSubpackage","name","completeCallback","loadBundle","now","Date","deltaTime","director","getDeltaTime","interval","_handleQueue","sort","a","b","pop","bind"],"mappings":"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"}