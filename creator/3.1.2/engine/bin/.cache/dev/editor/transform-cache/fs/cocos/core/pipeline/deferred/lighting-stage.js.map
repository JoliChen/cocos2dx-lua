{"version":3,"sources":["file:///Users/mac/jenkins/workspace/Creator_3D/daily_build_mac/resources/3d/engine/cocos/core/pipeline/deferred/lighting-stage.ts"],"names":["colors","Color","LIGHTINGPASS_INDEX","LightingStage","Material","RenderQueueDesc","RenderStage","_deferredLitsBufs","_maxDeferredLights","UBODeferredLight","LIGHTS_PER_PASS","_lightMeterScale","_descriptorSet","_renderArea","Rect","_phaseID","_defPhaseID","_renderQueues","material","val","_deferredMaterial","initialize","info","gatherLights","camera","pipeline","_pipeline","cmdBuff","commandBuffers","sphereLights","scene","spotLights","_sphere","Sphere","create","_vec4Array","Float32Array","exposure","idx","elementLen","Vec4","length","fieldLen","i","light","set","position","x","y","z","range","intersect","sphereFrustum","frustum","Vec3","toArray","_lightBufferData","color","useColorTemperature","tempRGB","colorTemperatureRGB","pipelineSceneData","isHDR","luminance","fpScale","size","spotAngle","direction","offset","updateBuffer","activate","flow","device","renderQueues","totalSize","BYTES_PER_ELEMENT","Math","ceil","capabilities","uboOffsetAlignment","createBuffer","BufferInfo","BufferUsageBit","UNIFORM","TRANSFER_DST","MemoryUsageBit","HOST","DEVICE","deferredLitsBufView","BufferViewInfo","layoutInfo","DescriptorSetLayoutInfo","localDescriptorSetLayout","bindings","_descriptorSetLayout","createDescriptorSetLayout","createDescriptorSet","DescriptorSetInfo","bindBuffer","UBOForwardLight","BINDING","_planarQueue","PlanarShadowQueue","destroy","render","renderObjects","update","gatherShadowPasses","dynamicOffsets","bindDescriptorSet","SetIndex","LOCAL","generateRenderArea","clearFlag","ClearFlagBit","COLOR","clearColor","scale","w","deferredData","getDeferredRenderData","framebuffer","lightingFrameBuffer","renderPass","beginRenderPass","clearDepth","clearStencil","GLOBAL","descriptorSet","pass","shader","builinDeferred","builtinResMgr","get","passes","ShaderPool","getShaderVariant","inputAssembler","quadIAOffscreen","pso","PipelineStateManager","getOrCreatePipelineState","bindPipelineState","bindInputAssembler","draw","forEach","renderQueueClearFunc","m","p","k","ro","subModels","model","subModel","phase","insertRenderPass","renderQueueSortFunc","recordCommandBuffer","endRenderPass","initInfo","name","priority","DeferredStagePriority","LIGHTING","tag","serializable"],"mappings":"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"}