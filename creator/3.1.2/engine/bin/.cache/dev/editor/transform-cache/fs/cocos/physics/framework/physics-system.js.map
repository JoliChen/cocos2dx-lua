{"version":3,"sources":["file:///Users/mac/jenkins/workspace/Creator_3D/daily_build_mac/resources/3d/engine/cocos/physics/framework/physics-system.ts"],"names":["legacyCC","internal","PhysicsGroup","PhysicsSystem","System","PHYSICS_NONE","selector","id","PHYSICS_BUILTIN","PHYSICS_CANNON","PHYSICS_AMMO","PHYSICS_PHYSX","instance","_instance","enable","_enable","value","allowSleep","_allowSleep","v","EDITOR","physicsWorld","setAllowSleep","maxSubSteps","_maxSubSteps","fixedTimeStep","_fixedTimeStep","gravity","_gravity","set","setGravity","sleepThreshold","_sleepThreshold","autoSimulation","_autoSimulation","defaultMaterial","_material","constructor","raycastClosestResult","PhysicsRayResult","raycastResults","collisionMatrix","CollisionMatrix","useNodeChains","_subStepCount","_accumulator","Vec3","PhysicsMaterial","raycastOptions","group","mask","queryTrigger","maxDistance","raycastResultPool","RecyclePool","config","game","physics","physicsEngine","copy","friction","rollingFriction","spinningFriction","restitution","i","key","parseInt","on","_updateMaterial","setDefaultMaterial","postUpdate","deltaTime","GAME_VIEW","_executeInEditMode","syncSceneToPhysics","director","emit","Director","EVENT_BEFORE_PHYSICS","step","emitEvents","syncAfterEvents","EVENT_AFTER_PHYSICS","resetAccumulator","time","raycast","worldRay","reset","length","raycastClosest","ID","once","EVENT_INIT","initPhysicsSystem","cg","collisionGroups","Array","forEach","name","index","Enum","update","oldIns","unregisterSystem","destroy","sys","registerSystem"],"mappings":"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"}