{"version":3,"sources":["file:///Users/mac/jenkins/workspace/Creator_3D/daily_build_mac/resources/3d/engine/cocos/physics/cannon/cannon-world.ts"],"names":["CannonWorld","impl","_world","setDefaultMaterial","mat","defaultMaterial","friction","restitution","CannonShape","idToMaterial","id","setAllowSleep","v","allowSleep","setGravity","gravity","Vec3","copy","constructor","bodies","constraints","CANNON","World","broadphase","NaiveBroadphase","solver","iterations","tolerance","defaultContactMaterial","contactEquationStiffness","frictionEquationStiffness","contactEquationRelaxation","frictionEquationRelaxation","destroy","length","emitEvents","emitTriggeredEvents","emitCollisionEvents","syncSceneToPhysics","i","syncAfterEvents","step","deltaTime","timeSinceLastCalled","maxSubStep","syncPhysicsToScene","raycastClosest","worldRay","options","result","setupFromAndTo","maxDistance","raycastOpt","hit","from","to","rayResult","raycast","pool","results","raycastAll","r","add","push","getSharedBody","node","wrappedBody","CannonSharedBody","addSharedBody","sharedBody","indexOf","addBody","body","removeSharedBody","remove","addConstraint","constraint","removeConstraint","RaycastResult","distance","o","computeHit","checkCollisionResponse","collisionFilterGroup","collisionFilterMask","skipBackfaces"],"mappings":"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"}