{"version":3,"sources":["file:///Users/mac/jenkins/workspace/Creator_3D/daily_build_mac/resources/3d/engine/cocos/core/renderer/scene/spot-light.ts"],"names":["_forward","Vec3","_qt","Quat","_matView","Mat4","_matProj","_matViewProj","_matViewProjInv","SpotLight","Light","position","_pos","size","LightPool","set","_handle","LightView","SIZE","get","range","_range","RANGE","_needUpdate","luminance","lum","ILLUMINANCE","direction","_dir","spotAngle","SPOT_ANGLE","val","_angle","Math","cos","aspect","ASPECT","aabb","_aabb","frustum","_frustum","constructor","_spotAngle","PI","_hAABB","NULL_HANDLE","_hFrustum","AABB","create","Frustum","initialize","AABBPool","alloc","FrustumPool","TYPE","LightType","SPOT","setVec3","DIRECTION","FRUSTUM","update","_node","hasChangedFlags","getWorldPosition","transformQuat","getWorldRotation","normalize","x","y","z","getWorldRT","invert","perspective","multiply","POSITION","AABBView","CENTER","center","HALF_EXTENSION","halfExtents","destroy","free"],"mappings":"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"}