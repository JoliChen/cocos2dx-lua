{"version":3,"sources":["file:///Users/mac/jenkins/workspace/Creator_3D/daily_build_mac/resources/3d/engine/cocos/particle-2d/motion-streak-2d-assembler.ts"],"names":["_tangent","Vec2","_normal","_vec2","normal","out","dir","x","y","computeMiter","miter","lineA","lineB","halfThick","maxMultiple","add","normalize","multiple","dot","Math","min","MotionStreakAssembler","createData","comp","renderData","requestRenderData","dataLength","vertexCount","indicesCount","update","dt","stroke","node","matrix","worldMatrix","tx","m12","ty","m13","points","cur","length","point","difx","dify","minSeg","MotionStreak","Point","splice","setPoint","time","fadeTime","verticesCount","color","cr","r","cg","g","cb","b","ca","a","prev","distance","subtract","setDir","data","findLast","i","p","progress","next","da","c","offset","u","v","_val","updateRenderData","fillBuffers","renderer","dataList","buffer","acquireBufferBatch","vertexOffset","byteOffset","indicesOffset","vertexId","isRecreate","request","currBufferBatch","vBuf","vData","iBuf","iData","vert","z","Color","toArray","l","start","MotionStreakAssemblerManager","getAssembler","Assembler"],"mappings":"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"}