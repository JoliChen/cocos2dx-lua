{"version":3,"sources":["file:///Users/mac/jenkins/workspace/Creator_3D/daily_build_mac/resources/3d/engine/cocos/core/renderer/scene/skybox.ts"],"names":["skybox_mesh","skybox_material","Skybox","model","_model","enabled","SkyboxPool","get","_handle","SkyboxView","ENABLE","val","set","activate","_updatePipeline","useIBL","USE_IBL","isRGBE","IS_RGBE","recompileShaders","USE_RGBE_CUBEMAP","setSubModelMaterial","envmap","_envmap","_default","legacyCC","director","root","pipeline","pipelineSceneData","ambient","albedoArray","mipmapLevel","_updateGlobalBinding","handle","constructor","_globalDSManager","NULL_HANDLE","alloc","initialize","skyboxInfo","globalDSManager","builtinResMgr","createModel","renderer","scene","Model","_initLocalDescriptors","MODEL","mat","Material","effectName","defines","MaterialInstance","parent","utils","createMesh","primitives","box","width","height","length","initSubModel","renderingSubMeshes","value","current","macros","CC_USE_IBL","onGlobalPipelineStateChanged","texture","getGFXTexture","sampler","samplerLib","getSampler","_device","getSamplerHash","bindSampler","UNIFORM_ENVIRONMENT_BINDING","bindTexture","update","destroy","free"],"mappings":"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"}