{"version":3,"sources":["file:///Users/mac/jenkins/workspace/Creator_3D/daily_build_mac/resources/3d/engine/cocos/core/pipeline/deferred/gbuffer-stage.ts"],"names":["colors","Color","GbufferStage","RenderQueueDesc","RenderStage","constructor","_renderQueues","_renderArea","Rect","_batchedQueue","_instancedQueue","_phaseID","RenderBatchedQueue","RenderInstancedQueue","initialize","info","renderQueues","activate","pipeline","flow","i","length","destroy","render","camera","clear","_pipeline","device","forEach","renderQueueClearFunc","renderObjects","pipelineSceneData","m","p","k","ro","subModels","model","subModel","passes","pass","phase","batchingScheme","BatchingSchemes","INSTANCING","instancedBuffer","InstancedBuffer","get","merge","instancedAttributes","queue","add","VB_MERGING","batchedBuffer","BatchedBuffer","insertRenderPass","renderQueueSortFunc","cmdBuff","commandBuffers","uploadBuffers","generateRenderArea","updateQuadVertexData","clearFlag","ClearFlagBit","COLOR","isHDR","clearColor","scale","fpScale","exposure","x","y","z","w","deferredData","getDeferredRenderData","framebuffer","gbufferFrameBuffer","renderPass","beginRenderPass","clearDepth","clearStencil","bindDescriptorSet","SetIndex","GLOBAL","descriptorSet","recordCommandBuffer","endRenderPass","initInfo","name","priority","DeferredStagePriority","GBUFFER","tag","isTransparent","sortMode","RenderQueueSortMode","FRONT_TO_BACK","stages","BACK_TO_FRONT","serializable"],"mappings":"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"}