{"version":3,"sources":["../../../../../../../../../../cocos/core/renderer/scene/model.ts"],"names":["uploadMat4AsVec4x3","mat","v1","v2","v3","m00","m01","m02","m12","m04","m05","m06","m13","m08","m09","m10","m14","builtinResMgr","AABB","Pool","Layers","SubModel","BatchingSchemes","legacyCC","InstancedBuffer","Mat4","Vec4","genSamplerHash","samplerLib","ShaderPool","SubModelPool","SubModelView","SubModelArrayPool","ModelPool","ModelView","AABBPool","AABBView","NULL_HANDLE","AttributeArrayPool","RawBufferPool","freeHandleArray","ObjectPool","PoolType","Attribute","BufferInfo","getTypedArrayConstructor","BufferUsageBit","FormatInfos","MemoryUsageBit","Filter","Address","Feature","INST_MAT_WORLD","UBOLocal","UNIFORM_LIGHTMAP_TEXTURE_BINDING","AttrPool","ATTRIBUTE","_","obj","m4_1","_subModelPool","shadowMapPatches","name","value","ModelType","lightmapSamplerHash","LINEAR","NONE","CLAMP","lightmapSamplerWithMipHash","Model","type","DEFAULT","scene","isDynamicBatching","instancedAttributes","buffer","views","attributes","_enabled","_worldBounds","_modelBounds","_subModels","_node","_transform","_visFlags","Enum","_device","_inited","_descriptorSetCount","_updateStamp","_transformUpdated","_handle","_hWorldBounds","_localData","Float32Array","COUNT","_localBuffer","_instMatWorldIdx","_lightmap","_lightmapUVParam","director","root","device","initialize","alloc","hSubModelArray","hInstancedAttrArray","set","INSTANCED_ATTR_ARRAY","SUB_MODEL_ARRAY","VIS_FLAGS","ENABLED","RECEIVE_SHADOW","CAST_SHADOW","destroy","subModels","i","length","subModel","free","get","hOldBuffer","INSTANCED_BUFFER","hAttrArray","attachToScene","detachFromScene","updateTransform","stamp","node","transform","hasChangedFlags","_dirtyFlags","updateWorldTransform","worldBounds","_mat","_pos","_rot","_scale","setVec3","CENTER","center","HALF_EXTENSION","halfExtents","updateWorldBound","updateUBOs","update","worldMatrix","idx","attrs","toArray","MAT_WORLD_OFFSET","inverseTranspose","MAT_WORLD_IT_OFFSET","createBoundingShape","minPos","maxPos","fromPoints","create","clone","WORLD_BOUNDS","initSubModel","subMeshData","isNewSubModel","passes","getMacroPatches","initPlanarShadowShader","initPlanarShadowInstanceShader","_updateAttributesAndBinding","assign","handle","setSubModelMesh","subMesh","setSubModelMaterial","onGlobalPipelineStateChanged","onPipelineStateChanged","onMacroPatchesStateChanged","updateLightingmap","texture","uvParam","LIGHTINGMAP_UVPARAM","gfxTexture","getGFXTexture","sampler","getSampler","mipmaps","descriptorSet","bindTexture","bindSampler","subModelIndex","receiveShadow","_initLocalDescriptors","_updateLocalDescriptors","shader","SHADER_0","_updateInstancedAttributes","_getInstancedAttributeIndex","pass","hasFeature","INSTANCED_ARRAYS","size","j","attribute","isInstanced","format","hBuffer","getBuffer","Uint8Array","offset","hAttr","attr","isNormalized","location","push","info","count","batchingScheme","INSTANCING","createBuffer","UNIFORM","TRANSFER_DST","HOST","DEVICE","SIZE","bindBuffer","BINDING","val","n","NODE","TRANSFORM"],"mappings":"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"}