{"version":3,"sources":["../../../../../../../../../cocos/3d/misc/create-mesh.ts"],"names":["createMesh","geometry","out","options","attributes","stride","channels","vertCount","attr","positions","slice","length","att","name","AttributeName","ATTR_POSITION","_defAttrs","push","info","FormatInfos","format","Math","max","floor","count","offset","data","attribute","size","normals","ATTR_NORMAL","uvs","ATTR_TEX_COORD","tangents","ATTR_TANGENT","colors","ATTR_COLOR","customAttributes","ca","values","bufferBlob","BufferBlob","vertexBuffer","ArrayBuffer","vertexBufferView","DataView","channel","writeBuffer","setNextAlignment","vertexBundle","view","getLength","byteLength","addBuffer","indexBuffer","idxCount","idxStride","indices","indexBufferView","Format","R16UI","primitive","primitiveMode","PrimitiveMode","TRIANGLE_LIST","vertexBundelIndices","indexView","minPosition","minPos","calculateBounds","Vec3","set","Infinity","iVertex","v3_1","min","maxPosition","maxPos","meshStruct","vertexBundles","primitives","x","y","z","Mesh","reset","struct","Uint8Array","getCombined","Attribute","RGB32F","RG32F","RGBA32F"],"mappings":";;;;;;;;;;;AAyCO,WAASA,UAAT,CAAqBC,QAArB,EAA0CC,GAA1C,EAAsDC,OAAtD,EAAqF;AACxFA,IAAAA,OAAO,GAAGA,OAAO,IAAI,EAArB,CADwF,CAExF;;AACA,QAAMC,UAAuB,GAAG,EAAhC;AACA,QAAIC,MAAM,GAAG,CAAb;AACA,QAAMC,QAAqE,GAAG,EAA9E;AACA,QAAIC,SAAS,GAAG,CAAhB;AAEA,QAAIC,IAAJ;AAEA,QAAMC,SAAS,GAAGR,QAAQ,CAACQ,SAAT,CAAmBC,KAAnB,EAAlB;;AACA,QAAID,SAAS,CAACE,MAAV,GAAmB,CAAvB,EAA0B;AACtBH,MAAAA,IAAI,GAAG,IAAP;;AACA,UAAIP,QAAQ,CAACG,UAAb,EAAyB;AACrB,6DAAkBH,QAAQ,CAACG,UAA3B,wCAAuC;AAAA,cAA5BQ,GAA4B;;AACnC,cAAIA,GAAG,CAACC,IAAJ,KAAaC,aAAa,CAACC,aAA/B,EAA8C;AAC1CP,YAAAA,IAAI,GAAGI,GAAP;AACA;AACH;AACJ;AACJ;;AAED,UAAI,CAACJ,IAAL,EAAW;AACPA,QAAAA,IAAI,GAAGQ,SAAS,CAAC,CAAD,CAAhB;AACH;;AAEDZ,MAAAA,UAAU,CAACa,IAAX,CAAgBT,IAAhB;AACA,UAAMU,IAAI,GAAGC,WAAW,CAACX,IAAI,CAACY,MAAN,CAAxB;AACAb,MAAAA,SAAS,GAAGc,IAAI,CAACC,GAAL,CAASf,SAAT,EAAoBc,IAAI,CAACE,KAAL,CAAWd,SAAS,CAACE,MAAV,GAAmBO,IAAI,CAACM,KAAnC,CAApB,CAAZ;AACAlB,MAAAA,QAAQ,CAACW,IAAT,CAAc;AAAEQ,QAAAA,MAAM,EAAEpB,MAAV;AAAkBqB,QAAAA,IAAI,EAAEjB,SAAxB;AAAmCkB,QAAAA,SAAS,EAAEnB;AAA9C,OAAd;AACAH,MAAAA,MAAM,IAAIa,IAAI,CAACU,IAAf;AACH;;AAED,QAAI3B,QAAQ,CAAC4B,OAAT,IAAoB5B,QAAQ,CAAC4B,OAAT,CAAiBlB,MAAjB,GAA0B,CAAlD,EAAqD;AACjDH,MAAAA,IAAI,GAAG,IAAP;;AACA,UAAIP,QAAQ,CAACG,UAAb,EAAyB;AACrB,8DAAkBH,QAAQ,CAACG,UAA3B,2CAAuC;AAAA,cAA5BQ,IAA4B;;AACnC,cAAIA,IAAG,CAACC,IAAJ,KAAaC,aAAa,CAACgB,WAA/B,EAA4C;AACxCtB,YAAAA,IAAI,GAAGI,IAAP;AACA;AACH;AACJ;AACJ;;AAED,UAAI,CAACJ,IAAL,EAAW;AACPA,QAAAA,IAAI,GAAGQ,SAAS,CAAC,CAAD,CAAhB;AACH;;AAED,UAAME,KAAI,GAAGC,WAAW,CAACX,IAAI,CAACY,MAAN,CAAxB;AACAhB,MAAAA,UAAU,CAACa,IAAX,CAAgBT,IAAhB;AACAD,MAAAA,SAAS,GAAGc,IAAI,CAACC,GAAL,CAASf,SAAT,EAAoBc,IAAI,CAACE,KAAL,CAAWtB,QAAQ,CAAC4B,OAAT,CAAiBlB,MAAjB,GAA0BO,KAAI,CAACM,KAA1C,CAApB,CAAZ;AACAlB,MAAAA,QAAQ,CAACW,IAAT,CAAc;AAAEQ,QAAAA,MAAM,EAAEpB,MAAV;AAAkBqB,QAAAA,IAAI,EAAEzB,QAAQ,CAAC4B,OAAjC;AAA0CF,QAAAA,SAAS,EAAEnB;AAArD,OAAd;AACAH,MAAAA,MAAM,IAAIa,KAAI,CAACU,IAAf;AACH;;AAED,QAAI3B,QAAQ,CAAC8B,GAAT,IAAgB9B,QAAQ,CAAC8B,GAAT,CAAapB,MAAb,GAAsB,CAA1C,EAA6C;AACzCH,MAAAA,IAAI,GAAG,IAAP;;AACA,UAAIP,QAAQ,CAACG,UAAb,EAAyB;AACrB,8DAAkBH,QAAQ,CAACG,UAA3B,2CAAuC;AAAA,cAA5BQ,KAA4B;;AACnC,cAAIA,KAAG,CAACC,IAAJ,KAAaC,aAAa,CAACkB,cAA/B,EAA+C;AAC3CxB,YAAAA,IAAI,GAAGI,KAAP;AACA;AACH;AACJ;AACJ;;AAED,UAAI,CAACJ,IAAL,EAAW;AACPA,QAAAA,IAAI,GAAGQ,SAAS,CAAC,CAAD,CAAhB;AACH;;AAED,UAAME,MAAI,GAAGC,WAAW,CAACX,IAAI,CAACY,MAAN,CAAxB;AACAhB,MAAAA,UAAU,CAACa,IAAX,CAAgBT,IAAhB;AACAD,MAAAA,SAAS,GAAGc,IAAI,CAACC,GAAL,CAASf,SAAT,EAAoBc,IAAI,CAACE,KAAL,CAAWtB,QAAQ,CAAC8B,GAAT,CAAapB,MAAb,GAAsBO,MAAI,CAACM,KAAtC,CAApB,CAAZ;AACAlB,MAAAA,QAAQ,CAACW,IAAT,CAAc;AAAEQ,QAAAA,MAAM,EAAEpB,MAAV;AAAkBqB,QAAAA,IAAI,EAAEzB,QAAQ,CAAC8B,GAAjC;AAAsCJ,QAAAA,SAAS,EAAEnB;AAAjD,OAAd;AACAH,MAAAA,MAAM,IAAIa,MAAI,CAACU,IAAf;AACH;;AAED,QAAI3B,QAAQ,CAACgC,QAAT,IAAqBhC,QAAQ,CAACgC,QAAT,CAAkBtB,MAAlB,GAA2B,CAApD,EAAuD;AACnDH,MAAAA,IAAI,GAAG,IAAP;;AACA,UAAIP,QAAQ,CAACG,UAAb,EAAyB;AACrB,8DAAkBH,QAAQ,CAACG,UAA3B,2CAAuC;AAAA,cAA5BQ,KAA4B;;AACnC,cAAIA,KAAG,CAACC,IAAJ,KAAaC,aAAa,CAACoB,YAA/B,EAA6C;AACzC1B,YAAAA,IAAI,GAAGI,KAAP;AACA;AACH;AACJ;AACJ;;AAED,UAAI,CAACJ,IAAL,EAAW;AACPA,QAAAA,IAAI,GAAGQ,SAAS,CAAC,CAAD,CAAhB;AACH;;AAED,UAAME,MAAI,GAAGC,WAAW,CAACX,IAAI,CAACY,MAAN,CAAxB;AACAhB,MAAAA,UAAU,CAACa,IAAX,CAAgBT,IAAhB;AACAD,MAAAA,SAAS,GAAGc,IAAI,CAACC,GAAL,CAASf,SAAT,EAAoBc,IAAI,CAACE,KAAL,CAAWtB,QAAQ,CAACgC,QAAT,CAAkBtB,MAAlB,GAA2BO,MAAI,CAACM,KAA3C,CAApB,CAAZ;AACAlB,MAAAA,QAAQ,CAACW,IAAT,CAAc;AAAEQ,QAAAA,MAAM,EAAEpB,MAAV;AAAkBqB,QAAAA,IAAI,EAAEzB,QAAQ,CAACgC,QAAjC;AAA2CN,QAAAA,SAAS,EAAEnB;AAAtD,OAAd;AACAH,MAAAA,MAAM,IAAIa,MAAI,CAACU,IAAf;AACH;;AAED,QAAI3B,QAAQ,CAACkC,MAAT,IAAmBlC,QAAQ,CAACkC,MAAT,CAAgBxB,MAAhB,GAAyB,CAAhD,EAAmD;AAC/CH,MAAAA,IAAI,GAAG,IAAP;;AACA,UAAIP,QAAQ,CAACG,UAAb,EAAyB;AACrB,8DAAkBH,QAAQ,CAACG,UAA3B,2CAAuC;AAAA,cAA5BQ,KAA4B;;AACnC,cAAIA,KAAG,CAACC,IAAJ,KAAaC,aAAa,CAACsB,UAA/B,EAA2C;AACvC5B,YAAAA,IAAI,GAAGI,KAAP;AACA;AACH;AACJ;AACJ;;AAED,UAAI,CAACJ,IAAL,EAAW;AACPA,QAAAA,IAAI,GAAGQ,SAAS,CAAC,CAAD,CAAhB;AACH;;AAED,UAAME,MAAI,GAAGC,WAAW,CAACX,IAAI,CAACY,MAAN,CAAxB;AACAhB,MAAAA,UAAU,CAACa,IAAX,CAAgBT,IAAhB;AACAD,MAAAA,SAAS,GAAGc,IAAI,CAACC,GAAL,CAASf,SAAT,EAAoBc,IAAI,CAACE,KAAL,CAAWtB,QAAQ,CAACkC,MAAT,CAAgBxB,MAAhB,GAAyBO,MAAI,CAACM,KAAzC,CAApB,CAAZ;AACAlB,MAAAA,QAAQ,CAACW,IAAT,CAAc;AAAEQ,QAAAA,MAAM,EAAEpB,MAAV;AAAkBqB,QAAAA,IAAI,EAAEzB,QAAQ,CAACkC,MAAjC;AAAyCR,QAAAA,SAAS,EAAEnB;AAApD,OAAd;AACAH,MAAAA,MAAM,IAAIa,MAAI,CAACU,IAAf;AACH;;AAED,QAAI3B,QAAQ,CAACoC,gBAAb,EAA+B;AAC3B,4DAAiBpC,QAAQ,CAACoC,gBAA1B,2CAA4C;AAAA,YAAjCC,EAAiC;AACxC,YAAMpB,MAAI,GAAGC,WAAW,CAACmB,EAAE,CAAC9B,IAAH,CAAQY,MAAT,CAAxB;AACAhB,QAAAA,UAAU,CAACa,IAAX,CAAgBqB,EAAE,CAAC9B,IAAnB;AACAD,QAAAA,SAAS,GAAGc,IAAI,CAACC,GAAL,CAASf,SAAT,EAAoBc,IAAI,CAACE,KAAL,CAAWe,EAAE,CAACC,MAAH,CAAU5B,MAAV,GAAmBO,MAAI,CAACM,KAAnC,CAApB,CAAZ;AACAlB,QAAAA,QAAQ,CAACW,IAAT,CAAc;AAAEQ,UAAAA,MAAM,EAAEpB,MAAV;AAAkBqB,UAAAA,IAAI,EAAEY,EAAE,CAACC,MAA3B;AAAmCZ,UAAAA,SAAS,EAAEW,EAAE,CAAC9B;AAAjD,SAAd;AACAH,QAAAA,MAAM,IAAIa,MAAI,CAACU,IAAf;AACH;AACJ,KAjIuF,CAmIxF;;;AACA,QAAMY,UAAU,GAAG,IAAIC,UAAJ,EAAnB,CApIwF,CAsIxF;;AACA,QAAMC,YAAY,GAAG,IAAIC,WAAJ,CAAgBpC,SAAS,GAAGF,MAA5B,CAArB;AACA,QAAMuC,gBAAgB,GAAG,IAAIC,QAAJ,CAAaH,YAAb,CAAzB;;AACA,iCAAsBpC,QAAtB,+BAAgC;AAA3B,UAAMwC,OAAO,gBAAb;AACDC,MAAAA,WAAW,CAACH,gBAAD,EAAmBE,OAAO,CAACpB,IAA3B,EAAiCoB,OAAO,CAACnB,SAAR,CAAkBP,MAAnD,EAA2D0B,OAAO,CAACrB,MAAnE,EAA2EpB,MAA3E,CAAX;AACH;;AACDmC,IAAAA,UAAU,CAACQ,gBAAX,CAA4B,CAA5B;AACA,QAAMC,YAAgC,GAAG;AACrC7C,MAAAA,UAAU,EAAVA,UADqC;AAErC8C,MAAAA,IAAI,EAAE;AACFzB,QAAAA,MAAM,EAAEe,UAAU,CAACW,SAAX,EADN;AAEFxC,QAAAA,MAAM,EAAE+B,YAAY,CAACU,UAFnB;AAGF5B,QAAAA,KAAK,EAAEjB,SAHL;AAIFF,QAAAA,MAAM,EAANA;AAJE;AAF+B,KAAzC;AASAmC,IAAAA,UAAU,CAACa,SAAX,CAAqBX,YAArB,EAtJwF,CAwJxF;;AACA,QAAIY,WAA+B,GAAG,IAAtC;AACA,QAAIC,QAAQ,GAAG,CAAf;AACA,QAAMC,SAAS,GAAG,CAAlB;;AACA,QAAIvD,QAAQ,CAACwD,OAAb,EAAsB;AAAA,UACVA,OADU,GACExD,QADF,CACVwD,OADU;AAElBF,MAAAA,QAAQ,GAAGE,OAAO,CAAC9C,MAAnB;AACA2C,MAAAA,WAAW,GAAG,IAAIX,WAAJ,CAAgBa,SAAS,GAAGD,QAA5B,CAAd;AACA,UAAMG,eAAe,GAAG,IAAIb,QAAJ,CAAaS,WAAb,CAAxB;AACAP,MAAAA,WAAW,CAACW,eAAD,EAAkBD,OAAlB,EAA2BE,MAAM,CAACC,KAAlC,CAAX;AACH,KAlKuF,CAoKxF;;;AACA,QAAMC,SAAwB,GAAG;AAC7BC,MAAAA,aAAa,EAAE7D,QAAQ,CAAC6D,aAAT,IAA0BC,aAAa,CAACC,aAD1B;AAE7BC,MAAAA,mBAAmB,EAAE,CAAC,CAAD;AAFQ,KAAjC;;AAKA,QAAIX,WAAJ,EAAiB;AACbd,MAAAA,UAAU,CAACQ,gBAAX,CAA4BQ,SAA5B;AACAK,MAAAA,SAAS,CAACK,SAAV,GAAsB;AAClBzC,QAAAA,MAAM,EAAEe,UAAU,CAACW,SAAX,EADU;AAElBxC,QAAAA,MAAM,EAAE2C,WAAW,CAACF,UAFF;AAGlB5B,QAAAA,KAAK,EAAE+B,QAHW;AAIlBlD,QAAAA,MAAM,EAAEmD;AAJU,OAAtB;AAMAhB,MAAAA,UAAU,CAACa,SAAX,CAAqBC,WAArB;AACH;;AAED,QAAIa,WAAW,GAAGlE,QAAQ,CAACmE,MAA3B;;AACA,QAAI,CAACD,WAAD,IAAgBhE,OAAO,CAACkE,eAA5B,EAA6C;AACzCF,MAAAA,WAAW,GAAGG,IAAI,CAACC,GAAL,CAAS,IAAID,IAAJ,EAAT,EAAqBE,QAArB,EAA+BA,QAA/B,EAAyCA,QAAzC,CAAd;;AACA,WAAK,IAAIC,OAAO,GAAG,CAAnB,EAAsBA,OAAO,GAAGlE,SAAhC,EAA2C,EAAEkE,OAA7C,EAAsD;AAClDH,QAAAA,IAAI,CAACC,GAAL,CAASG,IAAT,EAAejE,SAAS,CAACgE,OAAO,GAAG,CAAV,GAAc,CAAf,CAAxB,EAA2ChE,SAAS,CAACgE,OAAO,GAAG,CAAV,GAAc,CAAf,CAApD,EAAuEhE,SAAS,CAACgE,OAAO,GAAG,CAAV,GAAc,CAAf,CAAhF;AACAH,QAAAA,IAAI,CAACK,GAAL,CAASR,WAAT,EAAsBA,WAAtB,EAAmCO,IAAnC;AACH;AACJ;;AACD,QAAIE,WAAW,GAAG3E,QAAQ,CAAC4E,MAA3B;;AACA,QAAI,CAACD,WAAD,IAAgBzE,OAAO,CAACkE,eAA5B,EAA6C;AACzCO,MAAAA,WAAW,GAAGN,IAAI,CAACC,GAAL,CAAS,IAAID,IAAJ,EAAT,EAAqB,CAACE,QAAtB,EAAgC,CAACA,QAAjC,EAA2C,CAACA,QAA5C,CAAd;;AACA,WAAK,IAAIC,QAAO,GAAG,CAAnB,EAAsBA,QAAO,GAAGlE,SAAhC,EAA2C,EAAEkE,QAA7C,EAAsD;AAClDH,QAAAA,IAAI,CAACC,GAAL,CAASG,IAAT,EAAejE,SAAS,CAACgE,QAAO,GAAG,CAAV,GAAc,CAAf,CAAxB,EAA2ChE,SAAS,CAACgE,QAAO,GAAG,CAAV,GAAc,CAAf,CAApD,EAAuEhE,SAAS,CAACgE,QAAO,GAAG,CAAV,GAAc,CAAf,CAAhF;AACAH,QAAAA,IAAI,CAAChD,GAAL,CAASsD,WAAT,EAAsBA,WAAtB,EAAmCF,IAAnC;AACH;AACJ,KApMuF,CAsMxF;;;AACA,QAAMI,UAAwB,GAAG;AAC7BC,MAAAA,aAAa,EAAE,CAAC9B,YAAD,CADc;AAE7B+B,MAAAA,UAAU,EAAE,CAACnB,SAAD;AAFiB,KAAjC;;AAIA,QAAIM,WAAJ,EAAiB;AACbW,MAAAA,UAAU,CAACX,WAAX,GAAyB,IAAIG,IAAJ,CAASH,WAAW,CAACc,CAArB,EAAwBd,WAAW,CAACe,CAApC,EAAuCf,WAAW,CAACgB,CAAnD,CAAzB;AACH;;AACD,QAAIP,WAAJ,EAAiB;AACbE,MAAAA,UAAU,CAACF,WAAX,GAAyB,IAAIN,IAAJ,CAASM,WAAW,CAACK,CAArB,EAAwBL,WAAW,CAACM,CAApC,EAAuCN,WAAW,CAACO,CAAnD,CAAzB;AACH,KAhNuF,CAkNxF;;;AACA,QAAI,CAACjF,GAAL,EAAU;AACNA,MAAAA,GAAG,GAAG,IAAIkF,IAAJ,EAAN;AACH;;AACDlF,IAAAA,GAAG,CAACmF,KAAJ,CAAU;AACNC,MAAAA,MAAM,EAAER,UADF;AAENpD,MAAAA,IAAI,EAAE,IAAI6D,UAAJ,CAAe/C,UAAU,CAACgD,WAAX,EAAf;AAFA,KAAV;AAKA,WAAOtF,GAAP;AACH;;wBA5NeF,U;;;;AAhBPoF,MAAAA,I,iBAAAA,I;;AACAtE,MAAAA,a,mBAAAA,a;AAAe6C,MAAAA,M,mBAAAA,M;AAAQxC,MAAAA,W,mBAAAA,W;AAAa4C,MAAAA,a,mBAAAA,a;AAAe0B,MAAAA,S,mBAAAA,S;;AACnDnB,MAAAA,I,oBAAAA,I;;AAEAvB,MAAAA,W,aAAAA,W;;AACAN,MAAAA,U,iBAAAA,U;;;AAEHzB,MAAAA,S,GAAyB,CAC3B,IAAIyE,SAAJ,CAAc3E,aAAa,CAACC,aAA5B,EAA2C4C,MAAM,CAAC+B,MAAlD,CAD2B,EAE3B,IAAID,SAAJ,CAAc3E,aAAa,CAACgB,WAA5B,EAAyC6B,MAAM,CAAC+B,MAAhD,CAF2B,EAG3B,IAAID,SAAJ,CAAc3E,aAAa,CAACkB,cAA5B,EAA4C2B,MAAM,CAACgC,KAAnD,CAH2B,EAI3B,IAAIF,SAAJ,CAAc3E,aAAa,CAACoB,YAA5B,EAA0CyB,MAAM,CAACiC,OAAjD,CAJ2B,EAK3B,IAAIH,SAAJ,CAAc3E,aAAa,CAACsB,UAA5B,EAAwCuB,MAAM,CAACiC,OAA/C,CAL2B,C;AAQzBlB,MAAAA,I,GAAO,IAAIJ,IAAJ,E"}