{"version":3,"sources":["../../../../../../../../../../cocos/core/pipeline/deferred/gbuffer-stage.ts"],"names":["ccclass","displayOrder","type","serializable","SetIndex","getPhaseID","renderQueueClearFunc","convertRenderQueue","renderQueueSortFunc","ClearFlagBit","Color","Rect","SRGBToLinear","RenderBatchedQueue","RenderInstancedQueue","RenderStage","DeferredStagePriority","InstancedBuffer","BatchedBuffer","BatchingSchemes","RenderQueueDesc","RenderQueueSortMode","colors","GbufferStage","_renderQueues","_renderArea","_batchedQueue","_instancedQueue","_phaseID","initialize","info","renderQueues","activate","pipeline","flow","i","length","destroy","render","camera","clear","_pipeline","device","forEach","renderObjects","pipelineSceneData","m","p","k","ro","subModels","model","subModel","passes","pass","phase","batchingScheme","INSTANCING","instancedBuffer","get","merge","instancedAttributes","queue","add","VB_MERGING","batchedBuffer","insertRenderPass","cmdBuff","commandBuffers","uploadBuffers","generateRenderArea","updateQuadVertexData","clearFlag","COLOR","isHDR","clearColor","scale","fpScale","exposure","x","y","z","w","deferredData","getDeferredRenderData","framebuffer","gbufferFrameBuffer","renderPass","beginRenderPass","clearDepth","clearStencil","bindDescriptorSet","GLOBAL","descriptorSet","recordCommandBuffer","endRenderPass","initInfo","name","priority","GBUFFER","tag","isTransparent","sortMode","FRONT_TO_BACK","stages","BACK_TO_FRONT"],"mappings":"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"}