{"version":3,"sources":["../../../../../../../../../../cocos/core/pipeline/forward/forward-stage.ts"],"names":["ccclass","displayOrder","type","serializable","SetIndex","getPhaseID","renderQueueClearFunc","convertRenderQueue","renderQueueSortFunc","ClearFlagBit","Color","Rect","SRGBToLinear","RenderBatchedQueue","RenderInstancedQueue","RenderStage","ForwardStagePriority","RenderAdditiveLightQueue","InstancedBuffer","BatchedBuffer","BatchingSchemes","RenderQueueDesc","RenderQueueSortMode","PlanarShadowQueue","UIPhase","colors","ForwardStage","_renderQueues","_renderArea","_batchedQueue","_instancedQueue","_phaseID","_clearFlag","_uiPhase","initialize","info","renderQueues","activate","pipeline","flow","i","length","_additiveLightQueue","_pipeline","_planarQueue","destroy","render","camera","clear","device","forEach","renderObjects","pipelineSceneData","m","p","k","ro","subModels","model","subModel","passes","pass","phase","batchingScheme","INSTANCING","instancedBuffer","get","merge","instancedAttributes","queue","add","VB_MERGING","batchedBuffer","insertRenderPass","cmdBuff","commandBuffers","uploadBuffers","gatherLightPasses","gatherShadowPasses","sceneData","generateRenderArea","clearFlag","COLOR","isHDR","clearColor","scale","fpScale","exposure","x","y","z","w","framebuffer","window","renderPass","colorTextures","getRenderPass","beginRenderPass","clearDepth","clearStencil","bindDescriptorSet","GLOBAL","descriptorSet","recordCommandBuffer","endRenderPass","initInfo","name","priority","FORWARD","tag","isTransparent","sortMode","FRONT_TO_BACK","stages","BACK_TO_FRONT"],"mappings":"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"}