{"version":3,"sources":["../../../../../../../../../cocos/3d/misc/batch-utils.ts"],"names":["checkMaterialisSame","comp1","comp2","matNum","sharedMaterials","length","i","getRenderMaterial","MeshRenderer","Mesh","Mat4","BatchingUtility","batchStaticModel","staticModelRoot","batchedRoot","models","getComponentsInChildren","console","error","mesh","validateMergingMesh","node","name","batchedMesh","worldMat","rootWorldMatInv","getWorldMatrix","invert","comp","multiply","merge","enabled","batchedModel","addComponent","unbatchStaticModel","getComponent","destroyRenderingMesh","destroy"],"mappings":"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"}