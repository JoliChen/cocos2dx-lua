{"version":3,"sources":["../../../../../../../../../../cocos/2d/utils/dynamic-atlas/atlas.ts"],"names":["PixelFormat","Texture2D","BufferTextureCopy","legacyCC","space","Atlas","width","height","_texture","_width","_height","_x","_y","_nexty","_innerTextureInfos","_innerSpriteFrames","_count","texture","DynamicAtlasTexture","initWithSize","insertSpriteFrame","spriteFrame","rect","info","getId","sx","x","sy","y","internal","dynamicAtlasManager","textureBleeding","drawTextureAt","image","frame","push","deleteInnerTexture","isEmpty","reset","frames","i","l","length","isValid","_resetDynamicAtlasFrame","destroy","format","RGBA8888","loaded","emit","gfxTexture","getGFXTexture","gfxDevice","_getGFXDevice","console","warn","region","texOffset","texExtent","copyTexImagesToTexture","data"],"mappings":"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"}