{"version":3,"sources":["../../../../../../../../../cocos/3d/skeletal-animation/skeletal-animation-data-hub.ts"],"names":["convertToSkeletalCurves","clip","data","curves","forEach","curve","valueAdapter","isCustomPath","modifiers","HierarchyPath","isPropertyPath","path","cs","property","values","keys","frames","Math","ceil","sample","duration","props","Object","defineProperty","get","_worldMatrix","position","rotation","scale","convertToUniformSample","convertToWorldSpace","info","length","i","clone","isQuat","Quat","idx","time","from","denom","ratio","clamp01","slerp","lerp","convertedProps","oPos","oRot","oScale","matrix","map","Mat4","lastIndexOf","pMatrix","name","substring","console","warn","worldMatrix","oT","oR","oS","m","fromRTS","multiply","k","interpolate","legacyCC","SkelAnimDataHub","getOrExtract","pool","director","root","dataPoolManager","releaseAnimationClip","set","destroy","Map"],"mappings":"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"}