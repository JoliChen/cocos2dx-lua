{"version":3,"sources":["../../../../../../../../../cocos/physics/cannon/cannon-shared-body.ts"],"names":["CANNON","Quat","Vec3","ERigidBodyType","PhysicsGroup","getWrap","setWrap","PhysicsSystem","TransformBit","commitShapeUpdates","CannonContactEquation","fastRemoveAt","v3_0","quat_0","contactsPool","CollisionEventObject","type","selfCollider","otherCollider","contacts","impl","CannonSharedBody","getSharedBody","node","wrappedWorld","wrappedBody","key","uuid","newSB","sharedBodesMap","has","get","g","DEFAULT","m","instance","collisionMatrix","body","collisionFilterGroup","collisionFilterMask","set","rigidBody","_group","wrappedShapes","wrappedJoints0","wrappedJoints1","index","ref","onCollidedListener","onCollided","bind","Body","sleepSpeedLimit","sleepThreshold","material","defaultMaterial","addEventListener","addShape","v","indexOf","shapes","length","push","setIndex","offset","shapeOffsets","orient","shapeOrientations","setOffsetAndOrient","isSleeping","wakeUp","removeShape","addJoint","i","removeJoint","syncSceneToPhysics","hasChangedFlags","copy","position","worldPosition","quaternion","worldRotation","aabbNeedsUpdate","SCALE","syncScale","syncPhysicsToScene","n","b","DYNAMIC","syncInitial","previousPosition","previousQuaternion","setScale","worldScale","updateScale0","updateScale1","destroy","removeEventListener","World","idToBodyMap","id","event","self","selfShape","other","otherShape","collider","needCollisionEvent","apply","cq","c","pop","shape","emit","bodies","addSharedBody","isRemove","isEnabled","sleep","removeSharedBody","Map"],"mappings":"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"}