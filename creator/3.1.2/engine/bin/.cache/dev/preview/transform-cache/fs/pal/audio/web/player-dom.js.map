{"version":3,"sources":["../../../../../../../../../pal/audio/web/player-dom.ts"],"names":["ensurePlaying","domAudio","Promise","resolve","promise","play","undefined","then","onGesture","e","canvas","document","getElementById","addEventListener","once","system","AudioEvent","AudioState","AudioType","EventTarget","legacyCC","clamp","clamp01","enqueueOperation","BrowserType","OS","OneShotAudioDOM","nativeAudio","volume","_domAudio","_onPlayCb","_onEndCb","onPlay","stop","pause","cb","removeEventListener","AudioPlayerDOM","_state","INIT","_onHide","_onShow","_onEnded","_eventTarget","_operationQueue","PLAYING","INTERRUPTED","emit","INTERRUPTION_BEGIN","game","on","Game","EVENT_HIDE","INTERRUPTION_END","EVENT_SHOW","seek","ENDED","destroy","off","load","url","loadNative","reject","createElement","sys","loadedEvent","os","IOS","browserType","FIREFOX","timer","setTimeout","readyState","failure","success","clearEvent","clearTimeout","message","src","loadOneShotAudio","oneShotAudio","time","duration","currentTime","PAUSED","STOPPED","onInterruptionBegin","offInterruptionBegin","onInterruptionEnd","offInterruptionEnd","onEnded","offEnded","DOM_AUDIO","loop","val"],"mappings":"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"}