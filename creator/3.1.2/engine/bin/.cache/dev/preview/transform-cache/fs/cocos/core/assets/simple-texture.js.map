{"version":3,"sources":["../../../../../../../../../cocos/core/assets/simple-texture.ts"],"names":["getMipLevel","width","height","size","Math","max","level","isPOT","n","canGenerateMipmap","device","w","h","needCheckPOT","gfxAPI","API","WEBGL","ccclass","DEV","TextureFlagBit","TextureUsageBit","BufferTextureCopy","error","Filter","TextureBase","legacyCC","macro","dependUtil","fastRemoveAt","_regions","SimpleTexture","_gfxTexture","_mipmapLevel","_textureWidth","_textureHeight","getGFXTexture","destroy","_tryDestroyTexture","updateImage","updateMipmaps","firstLevel","count","uploadData","source","arrayIndex","gfxDevice","_getGFXDevice","region","texExtent","texSubres","mipLevel","baseArrayLayer","HTMLElement","name","ArrayBuffer","isView","copyBuffersToTexture","copyTexImagesToTexture","_assignImage","image","upload","data","_checkTextureLoaded","CLEANUP_IMAGE_CACHE","deps","getDeps","_uuid","index","indexOf","decRef","loaded","once","isCompressed","defaultImg","builtinResMgr","get","assetManager","postLoadNative","_textureReady","emit","_setMipmapLevel","value","_getGfxTextureCreateInfo","presumed","_tryReset","_createTexture","_width","_height","flags","NONE","_mipFilter","GEN_MIPMAP","textureCreateInfo","usage","SAMPLED","TRANSFER_DST","format","_getGFXFormat","levelCount","IMMUTABLE","texture","createTexture"],"mappings":"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"}