{"version":3,"sources":["../../../../../../../../../cocos/particle/renderer/particle-system-renderer-cpu.ts"],"names":["builtinResMgr","AttributeName","Format","Attribute","Mat4","Vec2","Vec3","Vec4","pseudoRandom","RecyclePool","MaterialInstance","RenderMode","Space","Particle","PARTICLE_MODULE_ORDER","ParticleSystemRendererBase","_tempAttribUV","_tempWorldTrans","_anim_module","_uvs","CC_USE_WORLD_SPACE","CC_RENDER_MODE","RENDER_MODE_BILLBOARD","RENDER_MODE_STRETCHED_BILLBOARD","RENDER_MODE_HORIZONTAL_BILLBOARD","RENDER_MODE_VERTICAL_BILLBOARD","RENDER_MODE_MESH","_vertex_attrs","ATTR_POSITION","RGB32F","ATTR_TEX_COORD","ATTR_TEX_COORD1","ATTR_TEX_COORD2","ATTR_COLOR","RGBA8","_vertex_attrs_stretch","ATTR_COLOR1","_vertex_attrs_mesh","ATTR_TEX_COORD3","ATTR_NORMAL","_matInsInfo","parent","owner","subModelIdx","ParticleSystemRendererCPU","info","_defines","_trailDefines","_frameTile_velLenScale","_defaultMat","_node_scale","_attrs","_particles","_defaultTrailMat","_updateList","Map","_animateList","_runAnimateList","Array","_fillDataFunc","_uScaleHandle","_uLenHandle","_inited","_localMat","_gravity","_model","CC_USE_BILLBOARD","CC_USE_STRETCHED_BILLBOARD","CC_USE_HORIZONTAL_BILLBOARD","CC_USE_VERTICAL_BILLBOARD","onInit","ps","_setVertexAttrib","_setFillFunc","_initModuleList","_initModel","updateMaterialParams","updateTrailMaterial","setVertexAttributes","clear","reset","_particleSystem","_trailModule","updateRenderData","enabled","updateRenderMode","getFreeParticle","length","capacity","add","getDefaultTrailMaterial","setNewParticle","p","forEach","val","pm","enable","needUpdate","name","needAnimate","i","len","push","enableModule","updateParticles","dt","node","getWorldMatrix","scaleSpace","Local","getScale","World","getWorldScale","mat","getMaterialInstance","pass","passes","setUniform","value","key","update","_simulationSpace","trailModule","trailEnable","simulationSpace","r","getRotation","fromQuat","transpose","data","remainingLifetime","set","animatedVelocity","removeParticle","removeAt","gravityFactor","gravityModifier","evaluate","startLifetime","randomSeed","x","y","z","w","transformMat4","velocity","copy","ultimateVelocity","animate","scaleAndAdd","position","idx","fi","textureModule","_textureAnimationModule","frameIndex","beforeRender","updateIA","getParticleCount","onMaterialModified","index","material","onRebuildPSO","setSubModelMaterial","_trailModel","_renderInfo","renderMode","Mesh","_fillMeshData","StrecthedBillboard","_fillStrecthedData","_fillNormalData","attrNum","size","rotation","color","_val","addParticleVertexData","j","_vertAttrs","slice","shareMaterial","sharedMaterial","effectName","_effectAsset","_name","mainTexture","getProperty","indexOf","setMaterial","get","setProperty","getHandle","vlenScale","Billboard","velocityScale","lengthScale","HorizontalBillboard","VerticalBillboard","console","warn","numTilesX","numTilesY","recompileShaders","updateMaterial","space"],"mappings":"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"}