{"version":3,"sources":["../../../../../../../../../../cocos/physics/cannon/shapes/cannon-terrain-shape.ts"],"names":["CANNON","CannonShape","Vec3","Quat","commitShapeUpdates","CANNON_AABB_LOCAL","AABB","CANNON_AABB","CANNON_TRANSFORM","Transform","Heightfield","prototype","calculateWorldAABB","pos","quat","min","max","frame","result","copy","position","quaternion","s","elementSize","data","lowerBound","set","minValue","upperBound","length","maxValue","toWorldFrame","CannonTerrainShape","setTerrain","v","_terrainID","_uuid","terrain","sizeI","getVertexCountI","sizeJ","getVertexCountJ","i","j","getHeight","options","tileSize","updateProperties","onComponentSet","collider","_shape","onLoad","impl","updateMinValue","updateMaxValue","updateBoundingSphereRadius","update","_index","_body","_setCenter","fromEuler","_orient","lpos","_offset","add","_collider"],"mappings":"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"}