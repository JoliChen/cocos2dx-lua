{"version":3,"sources":["../../../../../../../../../cocos/physics/cocos/builtin-world.ts"],"names":["Vec3","BuiltinSharedBody","ArrayCollisionMatrix","intersect","error","fastRemoveAt","hitPoint","TriggerEventObject","type","selfCollider","otherCollider","impl","BuiltInWorld","shapeArr","bodies","_shapeArrPrev","_collisionMatrix","_collisionMatrixPrev","setGravity","v","setAllowSleep","setDefaultMaterial","destroy","length","step","deltaTime","tmp","i","bodyA","j","bodyB","collisionFilterGroup","collisionFilterMask","intersects","syncSceneToPhysics","syncAfterEvents","emitEvents","emitTriggerEvent","raycastClosest","worldRay","options","out","tmp_d","Infinity","max_d","maxDistance","mask","body","shapes","shape","distance","resolve","worldShape","normalize","d","scaleAndAdd","o","_assign","collider","ZERO","raycast","pool","results","r","add","computeHit","push","getSharedBody","node","wrappedBody","addSharedBody","index","indexOf","removeSharedBody","shapeA","shapeB","set","id","get","emit","temp","matrix","reset"],"mappings":"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"}