{"version":3,"sources":["../../../../../../../../../cocos/physics/framework/physics-system.ts"],"names":["initPhysicsSystem","EDITOR","physics","game","config","cg","collisionGroups","Array","forEach","v","PhysicsGroup","name","index","Enum","update","oldIns","PhysicsSystem","instance","director","unregisterSystem","physicsWorld","destroy","sys","legacyCC","_instance","registerSystem","ID","Vec3","createPhysicsWorld","Director","System","PhysicsMaterial","RecyclePool","PhysicsRayResult","CollisionMatrix","selector","internal","raycastClosestResult","raycastResults","collisionMatrix","useNodeChains","_enable","_allowSleep","_maxSubSteps","_subStepCount","_fixedTimeStep","_autoSimulation","_accumulator","_sleepThreshold","_gravity","_material","raycastOptions","group","mask","queryTrigger","maxDistance","raycastResultPool","physicsEngine","copy","gravity","allowSleep","fixedTimeStep","maxSubSteps","sleepThreshold","autoSimulation","defaultMaterial","friction","rollingFriction","spinningFriction","restitution","i","key","parseInt","on","_updateMaterial","setGravity","setAllowSleep","setDefaultMaterial","postUpdate","deltaTime","GAME_VIEW","_executeInEditMode","syncSceneToPhysics","emit","EVENT_BEFORE_PHYSICS","step","emitEvents","syncAfterEvents","EVENT_AFTER_PHYSICS","resetAccumulator","time","raycast","worldRay","reset","length","raycastClosest","value","set","id","once","EVENT_INIT"],"mappings":"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"}