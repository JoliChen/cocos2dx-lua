{"version":3,"sources":["../../../../../../../../../../cocos/core/pipeline/shadow/shadow-stage.ts"],"names":["ccclass","Color","Rect","RenderStage","ForwardStagePriority","RenderShadowMapBatchedQueue","SetIndex","colors","ShadowStage","_shadowFrameBuffer","_renderArea","_light","setUsage","light","shadowFrameBuffer","destroy","_additiveShadowQueue","clear","clearFramebuffer","camera","w","clearColor","pipeline","_pipeline","cmdBuff","commandBuffers","renderPass","beginRenderPass","clearDepth","clearStencil","endRenderPass","render","pipelineSceneData","shadowInfo","shadows","shadingScale","gatherLightPasses","vp","viewport","shadowMapSize","size","x","y","width","height","device","bindDescriptorSet","GLOBAL","descriptorSet","recordCommandBuffer","activate","flow","initInfo","name","priority","FORWARD","tag"],"mappings":";;;;;;;;;;;AA8BSA,MAAAA,O,0BAAAA,O;;AACAC,MAAAA,K,eAAAA,K;AAAOC,MAAAA,I,eAAAA,I;;AACWC,MAAAA,W,kBAAAA,W;;AAClBC,MAAAA,oB,kBAAAA,oB;;AACAC,MAAAA,2B,kCAAAA,2B;;AAEAC,MAAAA,Q,aAAAA,Q;;;AAKHC,MAAAA,M,GAAkB,CAAC,IAAIN,KAAJ,CAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,EAAmB,CAAnB,CAAD,C;AAExB;AACA;AACA;AACA;;6BAEaO,W,WADZR,OAAO,CAAC,aAAD,C;;;;;;;;;;;gBAwBIS,kB,GAAyC,I;gBACzCC,W,GAAc,IAAIR,IAAJ,E;gBACdS,M,GAAuB,I;;;;;;AAd/B;AACJ;AACA;AACA;AACA;AACA;eACWC,Q,GAAP,kBAAiBC,KAAjB,EAA+BC,iBAA/B,EAA+D;AAC3D,eAAKH,MAAL,GAAcE,KAAd;AACA,eAAKJ,kBAAL,GAA0BK,iBAA1B;AACH,S;;eAOMC,O,GAAP,mBAAkB;AACd,eAAKC,oBAAL,CAA0BC,KAA1B;AACH,S;;eAEMC,gB,GAAP,0BAAyBC,MAAzB,EAAyC;AACrC,cAAI,CAAC,KAAKR,MAAN,IAAgB,CAAC,KAAKF,kBAA1B,EAA8C;AAAE;AAAS;;AACzDF,UAAAA,MAAM,CAAC,CAAD,CAAN,CAAUa,CAAV,GAAcD,MAAM,CAACE,UAAP,CAAkBD,CAAhC;AACA,cAAME,QAAQ,GAAG,KAAKC,SAAtB;AACA,cAAMC,OAAO,GAAGF,QAAQ,CAACG,cAAT,CAAwB,CAAxB,CAAhB;AACA,cAAMC,UAAU,GAAG,KAAKjB,kBAAL,CAAwBiB,UAA3C;AAEAF,UAAAA,OAAO,CAACG,eAAR,CAAwBD,UAAxB,EAAoC,KAAKjB,kBAAzC,EAA6D,KAAKC,WAAlE,EACIH,MADJ,EACYY,MAAM,CAACS,UADnB,EAC+BT,MAAM,CAACU,YADtC;AAEAL,UAAAA,OAAO,CAACM,aAAR;AACH,S;;eAEMC,M,GAAP,gBAAeZ,MAAf,EAA+B;AAC3B,cAAMG,QAAQ,GAAG,KAAKC,SAAtB;AACA,cAAMS,iBAAiB,GAAGV,QAAQ,CAACU,iBAAnC;AACA,cAAMC,UAAU,GAAGD,iBAAiB,CAACE,OAArC;AACA,cAAMC,YAAY,GAAGH,iBAAiB,CAACG,YAAvC;AAEA,cAAMX,OAAO,GAAGF,QAAQ,CAACG,cAAT,CAAwB,CAAxB,CAAhB;;AAEA,cAAI,CAAC,KAAKd,MAAN,IAAgB,CAAC,KAAKF,kBAA1B,EAA8C;AAAE;AAAS;;AACzD,eAAKO,oBAAL,CAA0BoB,iBAA1B,CAA4C,KAAKzB,MAAjD,EAAyDa,OAAzD;;AAEA,cAAMa,EAAE,GAAGlB,MAAM,CAACmB,QAAlB;AACA,cAAMC,aAAa,GAAGN,UAAU,CAACO,IAAjC;AACA,eAAK9B,WAAL,CAAiB+B,CAAjB,GAAqBJ,EAAE,CAACI,CAAH,GAAOF,aAAa,CAACE,CAA1C;AACA,eAAK/B,WAAL,CAAiBgC,CAAjB,GAAqBL,EAAE,CAACK,CAAH,GAAOH,aAAa,CAACG,CAA1C;AACA,eAAKhC,WAAL,CAAiBiC,KAAjB,GAA0BN,EAAE,CAACM,KAAH,GAAWJ,aAAa,CAACE,CAAzB,GAA6BN,YAAvD;AACA,eAAKzB,WAAL,CAAiBkC,MAAjB,GAA0BP,EAAE,CAACO,MAAH,GAAYL,aAAa,CAACG,CAA1B,GAA8BP,YAAxD;AAEA,cAAMU,MAAM,GAAGvB,QAAQ,CAACuB,MAAxB;AACA,cAAMnB,UAAU,GAAG,KAAKjB,kBAAL,CAAwBiB,UAA3C;AAEAF,UAAAA,OAAO,CAACG,eAAR,CAAwBD,UAAxB,EAAoC,KAAKjB,kBAAzC,EAA6D,KAAKC,WAAlE,EACIH,MADJ,EACYY,MAAM,CAACS,UADnB,EAC+BT,MAAM,CAACU,YADtC;AAGAL,UAAAA,OAAO,CAACsB,iBAAR,CAA0BxC,QAAQ,CAACyC,MAAnC,EAA2CzB,QAAQ,CAAC0B,aAApD;;AAEA,eAAKhC,oBAAL,CAA0BiC,mBAA1B,CAA8CJ,MAA9C,EAAsDnB,UAAtD,EAAkEF,OAAlE;;AAEAA,UAAAA,OAAO,CAACM,aAAR;AACH,S;;eAEMoB,Q,GAAP,kBAAiB5B,QAAjB,EAA4C6B,IAA5C,EAA8D;AAC1D,iCAAMD,QAAN,YAAe5B,QAAf,EAAyB6B,IAAzB;;AACA,eAAKnC,oBAAL,GAA4B,IAAIX,2BAAJ,CAAgCiB,QAAhC,CAA5B;AACH,S;;;QA7E4BnB,W,WAKfiD,Q,GAA6B;AACvCC,QAAAA,IAAI,EAAE,aADiC;AAEvCC,QAAAA,QAAQ,EAAElD,oBAAoB,CAACmD,OAFQ;AAGvCC,QAAAA,GAAG,EAAE;AAHkC,O"}