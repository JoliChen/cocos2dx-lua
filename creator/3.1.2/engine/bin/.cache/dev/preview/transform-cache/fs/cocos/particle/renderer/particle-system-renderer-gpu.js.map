{"version":3,"sources":["../../../../../../../../../cocos/particle/renderer/particle-system-renderer-gpu.ts"],"names":["EDITOR","builtinResMgr","AttributeName","Format","Attribute","Mat4","Vec2","Vec4","Quat","MaterialInstance","RenderMode","Space","Particle","packGradientRange","Pass","packCurveRangeXYZ","packCurveRangeZ","packCurveRangeXYZW","packCurveRangeN","packCurveRangeXY","ParticleSystemRendererBase","_tempWorldTrans","_tempVec4","_world_rot","_sample_num","_sample_interval","CC_USE_WORLD_SPACE","CC_RENDER_MODE","RENDER_MODE_BILLBOARD","RENDER_MODE_STRETCHED_BILLBOARD","RENDER_MODE_HORIZONTAL_BILLBOARD","RENDER_MODE_VERTICAL_BILLBOARD","RENDER_MODE_MESH","COLOR_OVER_TIME_MODULE_ENABLE","ROTATION_OVER_TIME_MODULE_ENABLE","SIZE_OVER_TIME_MODULE_ENABLE","VELOCITY_OVER_TIME_MODULE_ENABLE","FORCE_OVER_TIME_MODULE_ENABLE","TEXTURE_ANIMATION_MODULE_ENABLE","_vert_attr_name","POSITION_STARTTIME","VERT_SIZE_UV","VERT_ROTATION_UV","COLOR","DIR_LIFE","RANDOM_SEED","_gpu_vert_attr","RGBA32F","R32F","_gpu_vert_attr_mesh","ATTR_TEX_COORD","RGB32F","ATTR_TEX_COORD3","ATTR_NORMAL","ATTR_COLOR1","RGBA8","_matInsInfo","parent","owner","subModelIdx","ParticleSystemRendererGPU","info","_defines","_frameTile_velLenScale","_node_scale","_vertAttrs","_defaultMat","_particleNum","_tempParticle","_colorTexture","_forceTexture","_velocityTexture","_rotationTexture","_sizeTexture","_animTexture","_uTimeHandle","_uRotHandle","_inited","CC_USE_BILLBOARD","CC_USE_STRETCHED_BILLBOARD","CC_USE_HORIZONTAL_BILLBOARD","CC_USE_VERTICAL_BILLBOARD","onInit","ps","_setVertexAttrib","_initModel","updateMaterialParams","setVertexAttributes","updateRenderMode","_model","constructAttributeIndex","clear","updateRenderData","onDestroy","destroy","enableModule","name","val","pm","mat","_particleSystem","getMaterialInstance","initShaderUniform","recompileShaders","setSubModelMaterial","getFreeParticle","_capacity","setNewParticle","p","addGPUParticleVertexData","_time","updateParticles","dt","node","getWorldMatrix","scaleSpace","Local","getScale","World","getWorldScale","updateGPUParticles","updateShaderUniform","enabled","beforeRender","updateIA","pass","passes","x","y","setUniform","getWorldRotation","getHandle","enable","forceModule","_forceOvertimeModule","z","handle","binding","getBindingFromHandle","bindSampler","getGFXSampler","bindTexture","getGFXTexture","spaceHandle","space","modeHandle","height","velocityModule","_velocityOvertimeModule","speedModifier","colorModule","_colorOverLifetimeModule","color","roationModule","_rotationOvertimeModule","separateAxes","sizeModule","_sizeOvertimeModule","size","textureModule","_textureAnimationModule","startFrame","frameOverTime","infoHandle","numTilesX","numTilesY","cycleCount","getParticleCount","onMaterialModified","index","material","onRebuildPSO","_renderInfo","renderMode","StrecthedBillboard","slice","Mesh","shareMaterial","sharedMaterial","effectName","_effectAsset","_name","mainTexture","getProperty","indexOf","setMaterial","get","setProperty","_simulationSpace","Billboard","velocityScale","w","lengthScale","HorizontalBillboard","VerticalBillboard","console","warn","set","updateMaterial"],"mappings":"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"}