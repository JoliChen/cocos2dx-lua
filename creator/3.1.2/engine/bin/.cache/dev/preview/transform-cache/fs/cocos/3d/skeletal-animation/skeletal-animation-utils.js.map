{"version":3,"sources":["../../../../../../../../../cocos/3d/skeletal-animation/skeletal-animation-utils.ts"],"names":["selectJointsMediumFormat","device","hasFeature","Feature","TEXTURE_FLOAT","Format","RGBA32F","RGBA8","uploadJointDataLBS","out","base","mat","firstBone","m00","m01","m02","m12","m04","m05","m06","m13","m08","m09","m10","m14","uploadJointDataDQS","Mat4","toRTS","qt_1","v3_1","v3_2","Quat","copy","dq_0","dot","multiplyScalar","set","dq_1","x","y","z","multiply","w","roundUpTextureSize","targetLength","formatSize","formatScale","Math","sqrt","ceil","max","MINIMUM_JOINT_TEXTURE_SIZE","EDITOR","SkelAnimDataHub","getWorldTransformUntilRoot","AABB","Address","BufferUsageBit","Filter","FormatInfos","MemoryUsageBit","BufferInfo","Vec3","UBOSkinningAnimation","genSamplerHash","TextureBufferPool","uploadJointData","jointTextureSamplerHash","POINT","NONE","CLAMP","v3_3","v3_4","v3_min","v3_max","m4_1","m4_2","ab_1","Inf","Number","MAX_SAFE_INTEGER","JointTexturePool","_device","_pool","_textureBuffers","Map","_formatSize","_pixelsPerJoint","_customPool","_chunkIdxMap","format","size","initialize","roundUpFn","clear","destroy","registerCustomTextureLayouts","layouts","i","length","layout","chunkIdx","createChunk","textureLength","j","contents","content","skeleton","k","clips","clip","getDefaultPoseTexture","mesh","skinningRoot","hash","texture","get","bounds","has","refCount","joints","bindposes","textureBuffer","buildTexture","jointCount","bufSize","customChunkIdx","handle","undefined","alloc","Float32Array","BYTES_PER_ELEMENT","pixelOffset","start","skeletonHash","clipHash","readyToBeDeleted","boneSpaceBounds","getBoneSpaceBounds","offset","node","getChildByPath","inverseBindposes","bound","transform","getBoundary","min","IDENTITY","fromPoints","update","buffer","getSequencePoseTexture","clipData","getOrExtract","frames","info","animInfos","_createAnimInfos","f","push","curveData","downstream","bindposeIdx","bindposeCorrection","transformValid","boneSpaceBound","center","halfExtents","releaseHandle","free","releaseSkeleton","it","values","res","next","done","value","releaseAnimationClip","animPath","source","data","animNode","correctionPath","idx","lastIndexOf","substring","fromRTS","rotation","position","scale","parent","t","worldMatrix","JointAnimationInfo","getData","nodeID","createBuffer","UNIFORM","TRANSFER_DST","HOST","DEVICE","SIZE","dirty","switchClip"],"mappings":"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"}