{"version":3,"sources":["../../../../../../../../../cocos/core/assets/image-asset.ts"],"names":["isImageBitmap","imageSource","legacyCC","sys","capabilities","imageBitmap","ImageBitmap","fetchImageSource","_data","isNativeImage","ALIPAY","XIAOMI","BAIDU","JSB","_compressed","HTMLImageElement","HTMLCanvasElement","_getGlobalDevice","director","root","device","ccclass","override","EDITOR","MINIGAME","TEST","Feature","Asset","PixelFormat","warnID","ImageAsset","nativeAsset","_nativeData","_tex","_exportedExts","undefined","_format","RGBA8888","_width","_height","loaded","width","height","format","reset","data","_onDataComplete","HTMLElement","complete","addEventListener","err","message","destroy","src","_setRawAsset","close","_serialize","targetExtensions","_native","extensionIndices","targetExtension","extensionFormat","split","i","extnames","indexOf","exportedExtensionID","push","fmt","join","w","h","_deserialize","fmtStr","extensionIDs","defaultExt","preferedExtensionIndex","Number","MAX_VALUE","ext","SupportTextureFormats","macro","SUPPORT_TEXTURE_FORMATS","extensionID","extFormat","parseInt","tmpExt","index","hasFeature","FORMAT_ASTC","FORMAT_PVRTC","RGB_ETC1","RGBA_ETC1","FORMAT_ETC1","RGB_ETC2","RGBA_ETC2","FORMAT_ETC2","webp","emit","initDefault","uuid","_sharedPlaceHolderCanvas","canvas","document","createElement","context","getContext","l","fillStyle","fillRect","validate","value","RGBA_ASTC_12x12","RGB_A_PVRTC_2BPPV1","nativeUrl","tex","Texture2D","name","image"],"mappings":"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"}