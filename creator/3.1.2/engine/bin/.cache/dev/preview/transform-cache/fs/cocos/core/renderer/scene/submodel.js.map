{"version":3,"sources":["../../../../../../../../../../cocos/core/renderer/scene/submodel.ts"],"names":["RenderPriority","BatchingSchemes","DSPool","IAPool","SubModelPool","SubModelView","NULL_HANDLE","DescriptorSetInfo","legacyCC","errorID","_dsInfo","MAX_PASS_COUNT","SubModel","_device","_passes","_subMesh","_patches","_handle","_priority","DEFAULT","_inputAssembler","_descriptorSet","initialize","subMesh","passes","patches","director","root","device","alloc","_flushPassInfo","batchingScheme","VB_MERGING","genFlatBuffers","layout","localSetLayout","dsHandle","iaHandle","iaInfo","set","PRIORITY","INPUT_ASSEMBLER","DESCRIPTOR_SET","SUB_MESH","handle","get","initPlanarShadowShader","pipeline","shadowInfo","pipelineSceneData","shadows","shaderHandle","getPlanarShader","PLANAR_SHADER","initPlanarShadowInstanceShader","getPlanarInstanceShader","PLANAR_INSTANCE_SHADER","destroy","free","update","i","length","pass","onPipelineStateChanged","beginChangeStatesSilently","tryCompile","endChangeStatesSilently","onMacroPatchesStateChanged","PASS_COUNT","passOffset","PASS_0","shaderOffset","SHADER_0","getShaderVariant","passLengh","val"],"mappings":"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"}