{"version":3,"sources":["../../../../../../../../../cocos/3d/skeletal-animation/skeletal-animation-state.ts"],"names":["SkinnedMeshRenderer","Mat4","Quat","Vec3","AnimationState","SkelAnimDataHub","legacyCC","m4_1","m4_2","noCurves","SkeletalAnimationState","clip","name","_frames","_bakedDuration","_animInfo","_sockets","_animInfoMgr","_comps","_parent","_curvesInited","director","root","dataPoolManager","jointAnimationInfo","initialize","_curveLoaded","length","comps","getComponentsInChildren","i","comp","skinningRoot","push","getComponent","baked","useBakedAnimation","undefined","getOrExtract","info","frames","getData","uuid","sample","onPlay","_sampleCurves","_sampleCurvesBaked","duration","switchClip","uploadAnimation","_targetNode","rebuildSocketCurves","sockets","socket","targetNode","getChildByPath","path","target","clipData","animPath","source","data","animNode","downstream","idx","lastIndexOf","substring","identity","fromRTS","rotation","position","scale","multiply","parent","curveData","worldMatrix","values","transforms","f","mat","IDENTITY","tfm","pos","rot","toRTS","ratio","curFrame","dirty","setRTS"],"mappings":"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"}