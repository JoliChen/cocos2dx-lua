System.register(["./fog-01fb8507.js"],(function(e){"use strict";var t,r,n,i,o,s,a,u,c,h,p,f,l,_,g,d,y,b,v,m,w,I,T,E,k,O,S,C,L,x,P,B,A,z,R,N,D,j,M,F,U,H,G,V,Y,W,Z,J,X,K,Q,q,$,ee,te,re,ne,ie,oe,se,ae,ue,ce,he,pe,fe,le,_e,ge,de,ye;return{setters:[function(e){t=e.dH,r=e.et,n=e.dG,i=e.e8,o=e.eu,s=e.ev,a=e.ew,u=e.ex,c=e.ey,h=e.l,p=e.e1,f=e.y,l=e.x,_=e.b2,g=e.eg,d=e.cL,y=e.cK,b=e.c6,v=e.cJ,m=e.cI,w=e.c2,I=e.bT,T=e.bV,E=e.aG,k=e.ap,O=e.z,S=e.G,C=e.aI,L=e.cY,x=e.b1,P=e.cW,B=e.ej,A=e.ei,z=e.ez,R=e.f,N=e.en,D=e.em,j=e.d6,M=e.eo,F=e.dP,U=e.d,H=e.d0,G=e.eA,V=e.dV,Y=e.eB,W=e.e5,Z=e.eC,J=e.eD,X=e.bv,K=e.bw,Q=e.dU,q=e.dW,$=e.eE,ee=e.da,te=e.eF,re=e.bu,ne=e.eG,ie=e.eH,oe=e.eI,se=e.eJ,ae=e.eK,ue=e.ee,ce=e.eL,he=e.d3,pe=e.eM,fe=e.eN,le=e.eO,_e=e.eP,ge=e.eQ,de=e.t,ye=e.dQ}],execute:function(){var be,ve,me;e({f:bn,m:ke,r:function(e,t,r,n,i,o){void 0===t&&(t=l.R32F),void 0===r&&(r=0),void 0===n&&(n=e.byteLength-r),void 0===i&&(i=0),void 0===o&&(o=[]);var s=_[t];i||(i=s.size);for(var a="get"+Ee(s),u=s.size/s.count,c=Math.floor(n/i),h=g.isLittleEndian,p=0;p<c;++p)for(var f=r+i*p,d=0;d<s.count;++d){var y=f+u*d;o[s.count*p+d]=e[a](y,h)}return o},w:function(e,t,r,n,i){void 0===r&&(r=l.R32F),void 0===n&&(n=0),void 0===i&&(i=0);var o=_[r];i||(i=o.size);for(var s="set"+Ee(o),a=o.size/o.count,u=Math.floor(t.length/o.count),c=g.isLittleEndian,h=0;h<u;++h)for(var p=n+i*h,f=0;f<o.count;++f){var d=p+a*f;e[s](d,t[o.count*h+f],c)}}}),t(r.prototype,"TextureBase.prototype",[{name:"hasPremultipliedAlpha"},{name:"setPremultiplyAlpha"},{name:"setFlipY"}]),n(i.prototype,"RenderTexture.prototype",[{name:"getGFXWindow",customFunction:function(){return this._window}}]);var we,Ie=e("B",o("cc.BufferAsset")((me=function(e){function t(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(t=e.call.apply(e,[this].concat(n))||this)._buffer=null,t}s(t,e);var r=t.prototype;return r.buffer=function(){return this._buffer},r.validate=function(){return!!this.buffer},a(t,[{key:"_nativeAsset",get:function(){return this._buffer},set:function(e){e instanceof ArrayBuffer?this._buffer=e:this._buffer=e.buffer}}]),t}(p),u((ve=me).prototype,"_nativeAsset",[c],Object.getOwnPropertyDescriptor(ve.prototype,"_nativeAsset"),ve.prototype),be=ve))||be);h.BufferAsset=Ie;var Te=((we={})[f.UNORM]="Uint",we[f.SNORM]="Int",we[f.UINT]="Uint",we[f.INT]="Int",we[f.UFLOAT]="Float",we[f.FLOAT]="Float",we.default="Uint",we);function Ee(e){return""+(Te[e.type]||Te.default)+e.size/e.count*8}function ke(e,t,r,n,i,o,s){void 0===r&&(r=l.R32F),void 0===n&&(n=0),void 0===i&&(i=e.byteLength-n),void 0===o&&(o=0),s||(s=new DataView(e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)));var a=_[r];o||(o=a.size);for(var u="set"+Ee(a),c="get"+Ee(a),h=a.size/a.count,p=Math.floor(i/o),f=g.isLittleEndian,d=0;d<p;++d)for(var y=n+o*d,b=0;b<a.count;++b){var v=y+h*b,m=e[c](v,f);s[u](v,t(m,b,e),f)}return s}e("R",function(){function e(e,t,r,n,i){void 0===n&&(n=null),void 0===i&&(i=null),this.mesh=void 0,this.subMeshIdx=void 0,this._flatBuffers=[],this._jointMappedBuffers=void 0,this._jointMappedBufferIndices=void 0,this._vertexIdChannel=void 0,this._geometricInfo=void 0,this._vertexBuffers=void 0,this._attributes=void 0,this._indexBuffer=null,this._indirectBuffer=null,this._primitiveMode=void 0,this._iaInfo=void 0,this._handle=T,this._attributes=t,this._vertexBuffers=e,this._indexBuffer=n,this._indirectBuffer=i,this._primitiveMode=r,this._iaInfo=new C(t,e,n,i),this._handle=d.alloc();var o=w.alloc();d.set(this._handle,y.FLAT_BUFFER_ARRAY,o)}var t=e.prototype;return t.genFlatBuffers=function(){if(!this._flatBuffers.length&&this.mesh&&void 0!==this.subMeshIdx){var e=this.mesh,t=0,r=e.struct.primitives[this.subMeshIdx],n=d.get(this._handle,y.FLAT_BUFFER_ARRAY);r.indexView&&(t=r.indexView.count);for(var i=0;i<r.vertexBundelIndices.length;i++){var o=r.vertexBundelIndices[i],s=e.struct.vertexBundles[o],a=r.indexView?r.indexView.count:s.view.count,u=s.view.stride,c=u*a,h=new Uint8Array(e.data.buffer,s.view.offset,s.view.length),p=b.alloc(r.indexView?c:s.view.length),f=v.alloc();v.set(f,m.STRIDE,u),v.set(f,m.AMOUNT,a),v.set(f,m.BUFFER,p),w.push(n,f);var l=b.getBuffer(p),_=new Uint8Array(l);if(r.indexView){for(var g=e.readIndices(this.subMeshIdx),I=0;I<t;++I)for(var T=I*u,E=g[I]*u,k=0;k<u;++k)_[T+k]=h[E+k];this._flatBuffers.push({stride:u,count:a,buffer:_})}else _.set(e.data.subarray(s.view.offset,s.view.offset+s.view.length)),this._flatBuffers.push({stride:u,count:a,buffer:_})}}},t.destroy=function(){for(var e=0;e<this.vertexBuffers.length;e++)this.vertexBuffers[e].destroy();if(this.vertexBuffers.length=0,this._indexBuffer&&(this._indexBuffer.destroy(),this._indexBuffer=null),this._jointMappedBuffers&&this._jointMappedBufferIndices){for(var t=0;t<this._jointMappedBufferIndices.length;t++)this._jointMappedBuffers[this._jointMappedBufferIndices[t]].destroy();this._jointMappedBuffers=void 0,this._jointMappedBufferIndices=void 0}if(this._indirectBuffer&&(this._indirectBuffer.destroy(),this._indirectBuffer=null),this._handle){var r=d.get(this._handle,y.FLAT_BUFFER_ARRAY);I(r,w,v),d.free(this._handle),this._handle=T}},t.enableVertexIdChannel=function(e){if(!this._vertexIdChannel){var t=this.vertexBuffers.length,r=this.attributes.length,n=this._allocVertexIdBuffer(e);this._vertexBuffers.push(n),this._attributes.push(new E("a_vertexId",l.R32F,!1,t)),this._iaInfo.attributes=this._attributes,this._iaInfo.vertexBuffers=this._vertexBuffers,this._vertexIdChannel={stream:t,index:r}}},t._allocVertexIdBuffer=function(e){for(var t=0===this.vertexBuffers.length||0===this.vertexBuffers[0].stride?0:this.vertexBuffers[0].size/this.vertexBuffers[0].stride,r=new Float32Array(t),n=0;n<t;++n)r[n]=n+.5;var i=e.createBuffer(new k(O.VERTEX|O.TRANSFER_DST,S.DEVICE,r.byteLength,r.BYTES_PER_ELEMENT));return i.update(r),i},a(e,[{key:"attributes",get:function(){return this._attributes}},{key:"vertexBuffers",get:function(){return this._vertexBuffers}},{key:"indexBuffer",get:function(){return this._indexBuffer}},{key:"indirectBuffer",get:function(){return this._indirectBuffer}},{key:"primitiveMode",get:function(){return this._primitiveMode}},{key:"geometricInfo",get:function(){if(this._geometricInfo)return this._geometricInfo;if(void 0===this.mesh)return{positions:new Float32Array,indices:new Uint8Array,boundingBox:{min:L.ZERO,max:L.ZERO}};if(void 0===this.subMeshIdx)return{positions:new Float32Array,indices:new Uint8Array,boundingBox:{min:L.ZERO,max:L.ZERO}};var e=this.mesh,t=this.subMeshIdx,r=e.readAttribute(t,x.ATTR_POSITION),n=e.readIndices(t),i=new L,o=new L,s=this.attributes.find((function(e){return e.name===x.ATTR_POSITION}));if(s){var a=_[s.format].count;2===a?(i.set(r[0],r[1],0),o.set(r[0],r[1],0)):(i.set(r[0],r[1],r[2]),o.set(r[0],r[1],r[2]));for(var u=0;u<r.length;u+=a)2===a?(i.x=r[u]>i.x?r[u]:i.x,i.y=r[u+1]>i.y?r[u+1]:i.y,o.x=r[u]<o.x?r[u]:o.x,o.y=r[u+1]<o.y?r[u+1]:o.y):(i.x=r[u]>i.x?r[u]:i.x,i.y=r[u+1]>i.y?r[u+1]:i.y,i.z=r[u+2]>i.z?r[u+2]:i.z,o.x=r[u]<o.x?r[u]:o.x,o.y=r[u+1]<o.y?r[u+1]:o.y,o.z=r[u+2]<o.z?r[u+2]:o.z)}return this._geometricInfo={positions:r,indices:n,boundingBox:{max:i,min:o}},this._geometricInfo}},{key:"flatBuffers",get:function(){return this._flatBuffers}},{key:"jointMappedBuffers",get:function(){var e=this;if(this._jointMappedBuffers)return this._jointMappedBuffers;var t=this._jointMappedBuffers=[],r=this._jointMappedBufferIndices=[];if(!this.mesh||void 0===this.subMeshIdx)return this._jointMappedBuffers=this.vertexBuffers;var n,i,o=this.mesh.struct,s=o.primitives[this.subMeshIdx];if(!o.jointMaps||void 0===s.jointMapIndex||!o.jointMaps[s.jointMapIndex])return this._jointMappedBuffers=this.vertexBuffers;for(var a=h.director.root.device,u=0;u<s.vertexBundelIndices.length;u++){var c=o.vertexBundles[s.vertexBundelIndices[u]];i=0,n=l.UNKNOWN;for(var p=0;p<c.attributes.length;p++){var f=c.attributes[p];if(f.name===x.ATTR_JOINTS){n=f.format;break}i+=_[f.format].size}n?function(){var h=new Uint8Array(e.mesh.data.buffer,c.view.offset,c.view.length),p=new DataView(h.slice().buffer),f=o.jointMaps[s.jointMapIndex];ke(p,(function(e){return f.indexOf(e)}),n,i,c.view.length,c.view.stride,p);var l=a.createBuffer(new k(O.VERTEX|O.TRANSFER_DST,S.DEVICE,c.view.length,c.view.stride));l.update(p.buffer),t.push(l),r.push(u)}():t.push(this.vertexBuffers[s.vertexBundelIndices[u]])}return this._vertexIdChannel&&t.push(this._allocVertexIdBuffer(a)),t}},{key:"iaInfo",get:function(){return this._iaInfo}},{key:"handle",get:function(){return this._handle}}]),e}());var Oe=new Array(16),Se=null,Ce=new P,Le=[B.TOUCH_START.toString(),B.TOUCH_MOVE.toString(),B.TOUCH_END.toString(),B.TOUCH_CANCEL.toString()],xe=[B.MOUSE_DOWN.toString(),B.MOUSE_ENTER.toString(),B.MOUSE_MOVE.toString(),B.MOUSE_LEAVE.toString(),B.MOUSE_UP.toString(),B.MOUSE_WHEEL.toString()];function Pe(e,t){var r=this.owner;return!(!r||!r._uiProps.uiTransformComp||(e.getUILocation(Ce),!r._uiProps.uiTransformComp.isHit(Ce,this)||(t.type=B.TOUCH_START.toString(),t.touch=e,t.bubbles=!0,r.dispatchEvent(t),0)))}function Be(e,t){var r=this.owner;return!(!r||!r._uiProps.uiTransformComp||(t.type=B.TOUCH_MOVE.toString(),t.touch=e,t.bubbles=!0,r.dispatchEvent(t),0))}function Ae(e,t){var r=this.owner;r&&r._uiProps.uiTransformComp&&(e.getUILocation(Ce),r._uiProps.uiTransformComp.isHit(Ce,this)?t.type=B.TOUCH_END.toString():t.type=B.TOUCH_CANCEL.toString(),t.touch=e,t.bubbles=!0,r.dispatchEvent(t))}function ze(e,t){var r=this.owner;r&&r._uiProps.uiTransformComp&&(t.type=B.TOUCH_CANCEL.toString(),t.touch=e,t.bubbles=!0,r.dispatchEvent(t))}function Re(e){var t=this.owner;t&&t._uiProps.uiTransformComp&&(Ce=e.getUILocation(),t._uiProps.uiTransformComp.isHit(Ce,this)&&(e.type=B.MOUSE_DOWN.toString(),e.bubbles=!0,t.dispatchEvent(e)))}function Ne(e){var t=this.owner;if(t&&t._uiProps.uiTransformComp){if(Ce=e.getUILocation(),t._uiProps.uiTransformComp.isHit(Ce,this))this._previousIn||(Se&&Se.eventProcessor.mouseListener&&(e.type=B.MOUSE_LEAVE,Se.dispatchEvent(e),Se.eventProcessor.mouseListener&&(Se.eventProcessor.mouseListener._previousIn=!1)),Se=t,e.type=B.MOUSE_ENTER.toString(),t.dispatchEvent(e),this._previousIn=!0),e.type=B.MOUSE_MOVE.toString(),e.bubbles=!0,t.dispatchEvent(e);else{if(!this._previousIn)return;e.type=B.MOUSE_LEAVE.toString(),t.dispatchEvent(e),this._previousIn=!1,Se=null}e.propagationStopped=!0}}function De(e){var t=this.owner;t&&t._uiProps.uiTransformComp&&(Ce=e.getUILocation(),t._uiProps.uiTransformComp.isHit(Ce,this)&&(e.type=B.MOUSE_UP.toString(),e.bubbles=!0,t.dispatchEvent(e),e.propagationStopped=!0))}function je(e){var t=this.owner;t&&t._uiProps.uiTransformComp&&(Ce=e.getUILocation(),t._uiProps.uiTransformComp.isHit(Ce,this)&&(e.type=B.MOUSE_WHEEL.toString(),e.bubbles=!0,t.dispatchEvent(e),e.propagationStopped=!0))}function Me(e,t){if(t){for(var r=0,n=[],i=e;i&&N.isNode(i);i=i.parent,++r){var o=i.getComponent(t);if(o){var s={index:r,comp:o};n?n.push(s):n=[s]}}return n.length>0?n:null}return null}function Fe(e,t){if(!e._persistNode){if(e.eventProcessor.bubblingTargets)for(var r=0;r<t.length;++r)if(e.eventProcessor.bubblingTargets.hasEventListener(t[r]))return!0;if(e.eventProcessor.capturingTargets)for(var n=0;n<t.length;++n)if(e.eventProcessor.capturingTargets.hasEventListener(t[n]))return!0;return!1}return!0}var Ue,He=e("b",function(){function e(e){this.bubblingTargets=null,this.capturingTargets=null,this.touchListener=null,this.mouseListener=null,this._node=void 0,this._node=e}var t=e.prototype;return t.reattach=function(){var t;this.node.walk((function(r){t||(t=Me(r,e._comp)),r.eventProcessor.touchListener&&(r.eventProcessor.touchListener.mask=t),r.eventProcessor.mouseListener&&(r.eventProcessor.mouseListener.mask=t)}))},t.destroy=function(){Se===this._node&&(Se=null),(this.touchListener||this.mouseListener)&&(A.removeListeners(this._node),this.touchListener&&(this.touchListener.owner=null,this.touchListener.mask=null,this.touchListener=null),this.mouseListener&&(this.mouseListener.owner=null,this.mouseListener.mask=null,this.mouseListener=null)),this.capturingTargets&&this.capturingTargets.clear(),this.bubblingTargets&&this.bubblingTargets.clear()},t.on=function(e,t,r,n){return this._checknSetupSysEvent(e)?this._onDispatch(e,t,r,n):(this.bubblingTargets||(this.bubblingTargets=new z),this.bubblingTargets.on(e,t,r))},t.once=function(e,t,r,n){var i,o=this;(i=this._checknSetupSysEvent(e)&&n?this.capturingTargets=this.capturingTargets||new z:this.bubblingTargets=this.bubblingTargets||new z).on(e,t,r,!0),i.on(e,(function(){o.off(e,t,r)}),void 0,!0)},t.off=function(e,t,r,n){var i=-1!==Le.indexOf(e),o=!i&&-1!==xe.indexOf(e);i||o?(this._offDispatch(e,t,r,n),i?this.touchListener&&!Fe(this._node,Le)&&(A.removeListener(this.touchListener),this.touchListener=null):o&&this.mouseListener&&!Fe(this._node,xe)&&(A.removeListener(this.mouseListener),this.mouseListener=null)):this.bubblingTargets&&this.bubblingTargets.off(e,t,r)},t.emit=function(e,t,r,n,i,o){this.bubblingTargets&&this.bubblingTargets.emit(e,t,r,n,i,o)},t.dispatchEvent=function(e){!function(e,t){var r,n=0;for(t.target=e,Oe.length=0,e.eventProcessor.getCapturingTargets(t.type,Oe),t.eventPhase=1,n=Oe.length-1;n>=0;--n)if((r=Oe[n]).eventProcessor.capturingTargets&&(t.currentTarget=r,r.eventProcessor.capturingTargets.emit(t.type,t,Oe),t.propagationStopped))return void(Oe.length=0);if(Oe.length=0,t.eventPhase=2,t.currentTarget=e,e.eventProcessor.capturingTargets&&e.eventProcessor.capturingTargets.emit(t.type,t),!t.propagationImmediateStopped&&e.eventProcessor.bubblingTargets&&e.eventProcessor.bubblingTargets.emit(t.type,t),!t.propagationStopped&&t.bubbles)for(e.eventProcessor.getBubblingTargets(t.type,Oe),t.eventPhase=3,n=0;n<Oe.length;++n)if((r=Oe[n]).eventProcessor.bubblingTargets&&(t.currentTarget=r,r.eventProcessor.bubblingTargets.emit(t.type,t),t.propagationStopped))return void(Oe.length=0);Oe.length=0}(this._node,e),Oe.length=0},t.hasEventListener=function(e,t,r){var n=!1;return this.bubblingTargets&&(n=this.bubblingTargets.hasEventListener(e,t,r)),!n&&this.capturingTargets&&(n=this.capturingTargets.hasEventListener(e,t,r)),n},t.targetOff=function(e){this.capturingTargets&&this.capturingTargets.removeAll(e),this.bubblingTargets&&this.bubblingTargets.removeAll(e),this.touchListener&&!Fe(this.node,Le)&&(A.removeListener(this.touchListener),this.touchListener=null),this.mouseListener&&!Fe(this.node,xe)&&(A.removeListener(this.mouseListener),this.mouseListener=null)},t.getCapturingTargets=function(e,t){for(var r=this._node.parent;r;)r.eventProcessor.capturingTargets&&r.eventProcessor.capturingTargets.hasEventListener(e)&&t.push(r),r=r.parent},t.getBubblingTargets=function(e,t){for(var r=this._node.parent;r;)r.eventProcessor.bubblingTargets&&r.eventProcessor.bubblingTargets.hasEventListener(e)&&t.push(r),r=r.parent},t._checknSetupSysEvent=function(t){var r=this,n=!1,i=!1;return-1!==Le.indexOf(t)?(this.touchListener||(this.touchListener=h.EventListener.create({event:h.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,owner:this._node,mask:Me(this._node,e._comp),onTouchBegan:Pe,onTouchMoved:Be,onTouchEnded:Ae,onTouchCancelled:ze}),A.addListener(this.touchListener,this._node),n=!0),i=!0):-1!==xe.indexOf(t)&&(this.mouseListener||(this.mouseListener=h.EventListener.create({event:h.EventListener.MOUSE,_previousIn:!1,owner:this._node,mask:Me(this._node,e._comp),onMouseDown:Re,onMouseMove:Ne,onMouseUp:De,onMouseScroll:je}),A.addListener(this.mouseListener,this._node),n=!0),i=!0),n&&!this._node.activeInHierarchy&&h.director.getScheduler().schedule((function(){r._node.activeInHierarchy||A.pauseTarget(r._node)}),this._node,0,0,0,!1),i},t._onDispatch=function(e,t,r,n){if("boolean"==typeof r?(n=r,r=void 0):n=!!n,t){var i=null;return(i=n?this.capturingTargets=this.capturingTargets||new z:this.bubblingTargets=this.bubblingTargets||new z).hasEventListener(e,t,r)||i.on(e,t,r),t}R(6800)},t._offDispatch=function(e,t,r,n){if("boolean"==typeof r?(n=r,r=void 0):n=!!n,t){var i=n?this.capturingTargets:this.bubblingTargets;i&&i.off(e,t,r)}else this.capturingTargets&&this.capturingTargets.removeAll(e),this.bubblingTargets&&this.bubblingTargets.removeAll(e)},a(e,[{key:"node",get:function(){return this._node}}]),e}());He._comp=null,h.NodeEventProcessor=He,n(D.prototype,"BaseNode",[{name:"childrenCount",newName:"children.length",customGetter:function(){return this.children.length}}]),n(N.prototype,"Node",[{name:"width",targetName:"node.getComponent(UITransform)",customGetter:function(){return this._uiProps.uiTransformComp.width},customSetter:function(e){this._uiProps.uiTransformComp.width=e}},{name:"height",targetName:"node.getComponent(UITransform)",customGetter:function(){return this._uiProps.uiTransformComp.height},customSetter:function(e){this._uiProps.uiTransformComp.height=e}},{name:"anchorX",targetName:"node.getComponent(UITransform)",customGetter:function(){return this._uiProps.uiTransformComp.anchorX},customSetter:function(e){this._uiProps.uiTransformComp.anchorX=e}},{name:"anchorY",targetName:"node.getComponent(UITransform)",customGetter:function(){return this._uiProps.uiTransformComp.anchorY},customSetter:function(e){this._uiProps.uiTransformComp.anchorY=e}},{name:"getAnchorPoint",targetName:"node.getComponent(UITransform)",customFunction:function(e){return e||(e=new P),e.set(this._uiProps.uiTransformComp.anchorPoint),e}},{name:"setAnchorPoint",targetName:"node.getComponent(UITransform)",customFunction:function(e,t){this._uiProps.uiTransformComp.setAnchorPoint(e,t)}},{name:"getContentSize",targetName:"node.getComponent(UITransform)",customFunction:function(e){return e||(e=new j),e.set(this._uiProps.uiTransformComp.contentSize),e}},{name:"setContentSize",targetName:"node.getComponent(UITransform)",customFunction:function(e,t){"number"==typeof e?this._uiProps.uiTransformComp.setContentSize(e,t):this._uiProps.uiTransformComp.setContentSize(e)}}]),t(N.prototype,"Node.prototype",[{name:"addLayer"},{name:"removeLayer"}]),t(M,"Layers",[{name:"All"},{name:"RaycastMask"},{name:"check"}]),n(M,"Layers",[{name:"Default",newName:"DEFAULT",target:M.Enum,targetName:"Layers.Enum"},{name:"Always",newName:"ALWAYS",target:M.Enum,targetName:"Layers.Enum"},{name:"IgnoreRaycast",newName:"IGNORE_RAYCAST",target:M.Enum,targetName:"Layers.Enum"},{name:"Gizmos",newName:"GIZMOS",target:M.Enum,targetName:"Layers.Enum"},{name:"Editor",newName:"EDITOR",target:M.Enum,targetName:"Layers.Enum"},{name:"UI",newName:"UI_3D",target:M.Enum,targetName:"Layers.Enum"},{name:"UI2D",newName:"UI_2D",target:M.Enum,targetName:"Layers.Enum"},{name:"SceneGizmo",newName:"SCENE_GIZMO",target:M.Enum,targetName:"Layers.Enum"},{name:"makeInclusiveMask",newName:"makeMaskInclude",target:M,targetName:"Layers"},{name:"makeExclusiveMask",newName:"makeMaskExclude",target:M,targetName:"Layers"}]),t(M.Enum,"Layers.Enum",[{name:"ALWAYS"}]),t(M.BitMask,"Layers.BitMask",[{name:"ALWAYS"}]);var Ge,Ve,Ye,We,Ze,Je,Xe,Ke,Qe,qe,$e,et,tt,rt,nt,it,ot,st,at,ut,ct,ht,pt,ft,lt,_t,gt,dt,yt,bt,vt,mt,wt,It,Tt,Et,kt,Ot,St,Ct,Lt,xt,Pt,Bt,At,zt,Rt,Nt,Dt,jt,Mt,Ft,Ut,Ht,Gt,Vt,Yt,Wt,Zt,Jt,Xt,Kt,Qt,qt,$t,er,tr,rr,nr,ir,or,sr,ar,ur,cr,hr,pr,fr,lr,_r,gr,dr,yr,br,vr,mr,wr,Ir,Tr,Er,kr,Or,Sr,Cr,Lr,xr,Pr,Br,Ar,zr,Rr,Nr,Dr,jr,Mr,Fr,Ur,Hr,Gr,Vr,Yr,Wr,Zr,Jr,Xr,Kr,Qr,qr,$r,en=F.Flags.HideInHierarchy,tn=F.Flags.DontSave,rn=e("P",o("cc.PrivateNode")(Ue=function(e){function t(t){var r;return r=e.call(this,t)||this,U(12003,r.name),r.hideFlags|=tn|en,r}return s(t,e),t}(N))||Ue);h.PrivateNode=rn;var nn=new L(0,1,0),on=new L,sn=new H,an=(Ge=o("cc.AmbientInfo"),Ve=G(V),Ge((Ke=function(){function e(){$(this,"_skyColor",Ze,this),$(this,"_skyIllum",Je,this),$(this,"_groundAlbedo",Xe,this),this._resource=null}return e.prototype.activate=function(e){this._resource=e,this._resource.initialize(this)},a(e,[{key:"skyColor",get:function(){return this._skyColor},set:function(e){this._skyColor.set(e),this._resource&&(this._resource.skyColor=this._skyColor)}},{key:"skyIllum",get:function(){return this._skyIllum},set:function(e){this._skyIllum=e,this._resource&&(this._resource.skyIllum=this.skyIllum)}},{key:"groundAlbedo",get:function(){return this._groundAlbedo},set:function(e){this._groundAlbedo.set(e),this._resource&&(this._resource.groundAlbedo=this._groundAlbedo)}}]),e}(),Ze=u((We=Ke).prototype,"_skyColor",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ee(51,128,204,1)}}),Je=u(We.prototype,"_skyIllum",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return re.SKY_ILLUM}}),Xe=u(We.prototype,"_groundAlbedo",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ee(51,51,51,255)}}),u(We.prototype,"skyColor",[Y],Object.getOwnPropertyDescriptor(We.prototype,"skyColor"),We.prototype),u(We.prototype,"skyIllum",[Y,Ve],Object.getOwnPropertyDescriptor(We.prototype,"skyIllum"),We.prototype),u(We.prototype,"groundAlbedo",[Y],Object.getOwnPropertyDescriptor(We.prototype,"groundAlbedo"),We.prototype),Ye=We))||Ye);h.AmbientInfo=an;var un=(Qe=o("cc.SkyboxInfo"),qe=G(W),$e=G(W),Qe((st=function(){function e(){$(this,"_envmap",rt,this),$(this,"_isRGBE",nt,this),$(this,"_enabled",it,this),$(this,"_useIBL",ot,this),this._resource=null}return e.prototype.activate=function(e){this._resource=e,this._resource.initialize(this),this._resource.activate()},a(e,[{key:"enabled",get:function(){return this._enabled},set:function(e){this._enabled!==e&&(this._enabled=e,this._resource&&(this._resource.enabled=this._enabled))}},{key:"useIBL",get:function(){return this._useIBL},set:function(e){this._useIBL=e,this._resource&&(this._resource.useIBL=this._useIBL)}},{key:"envmap",get:function(){return this._envmap},set:function(e){this._envmap=e,this._resource&&(this._resource.envmap=this._envmap)}},{key:"isRGBE",get:function(){return this._isRGBE},set:function(e){this._isRGBE=e,this._resource&&(this._resource.isRGBE=this._isRGBE)}}]),e}(),rt=u((tt=st).prototype,"_envmap",[qe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),nt=u(tt.prototype,"_isRGBE",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),it=u(tt.prototype,"_enabled",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ot=u(tt.prototype,"_useIBL",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),u(tt.prototype,"enabled",[Y],Object.getOwnPropertyDescriptor(tt.prototype,"enabled"),tt.prototype),u(tt.prototype,"useIBL",[Y],Object.getOwnPropertyDescriptor(tt.prototype,"useIBL"),tt.prototype),u(tt.prototype,"envmap",[Y,$e],Object.getOwnPropertyDescriptor(tt.prototype,"envmap"),tt.prototype),u(tt.prototype,"isRGBE",[Y],Object.getOwnPropertyDescriptor(tt.prototype,"isRGBE"),tt.prototype),et=tt))||et);h.SkyboxInfo=un;var cn=(at=o("cc.FogInfo"),ut=G(Z),ct=ne(),ht=G(V),pt=ie(),ft=oe(),lt=se(),_t=ne(),gt=G(V),dt=oe(),yt=se(),bt=ne(),vt=G(V),mt=oe(),wt=se(),It=ne(),Tt=G(V),Et=ae(),kt=oe(),Ot=se(),St=ne(),Ct=G(V),Lt=oe(),xt=se(),Pt=ne(),Bt=G(V),At=oe(),zt=se(),at((Zt=Wt=function(){function e(){$(this,"_type",Dt,this),$(this,"_fogColor",jt,this),$(this,"_enabled",Mt,this),$(this,"_fogDensity",Ft,this),$(this,"_fogStart",Ut,this),$(this,"_fogEnd",Ht,this),$(this,"_fogAtten",Gt,this),$(this,"_fogTop",Vt,this),$(this,"_fogRange",Yt,this),this._resource=null}return e.prototype.activate=function(e){this._resource=e,this._resource.initialize(this),this._resource.activate()},a(e,[{key:"enabled",get:function(){return this._enabled},set:function(e){this._enabled!==e&&(this._enabled=e,this._resource&&(this._resource.enabled=e,e&&(this._resource.type=this._type)))}},{key:"fogColor",get:function(){return this._fogColor},set:function(e){this._fogColor.set(e),this._resource&&(this._resource.fogColor=this._fogColor)}},{key:"type",get:function(){return this._type},set:function(e){this._type=e,this._resource&&(this._resource.type=e)}},{key:"fogDensity",get:function(){return this._fogDensity},set:function(e){this._fogDensity=e,this._resource&&(this._resource.fogDensity=e)}},{key:"fogStart",get:function(){return this._fogStart},set:function(e){this._fogStart=e,this._resource&&(this._resource.fogStart=e)}},{key:"fogEnd",get:function(){return this._fogEnd},set:function(e){this._fogEnd=e,this._resource&&(this._resource.fogEnd=e)}},{key:"fogAtten",get:function(){return this._fogAtten},set:function(e){this._fogAtten=e,this._resource&&(this._resource.fogAtten=e)}},{key:"fogTop",get:function(){return this._fogTop},set:function(e){this._fogTop=e,this._resource&&(this._resource.fogTop=e)}},{key:"fogRange",get:function(){return this._fogRange},set:function(e){this._fogRange=e,this._resource&&(this._resource.fogRange=e)}}]),e}(),Wt.FogType=Z,Dt=u((Nt=Zt).prototype,"_type",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Z.LINEAR}}),jt=u(Nt.prototype,"_fogColor",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ee("#C8C8C8")}}),Mt=u(Nt.prototype,"_enabled",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ft=u(Nt.prototype,"_fogDensity",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.3}}),Ut=u(Nt.prototype,"_fogStart",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),Ht=u(Nt.prototype,"_fogEnd",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 300}}),Gt=u(Nt.prototype,"_fogAtten",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),Vt=u(Nt.prototype,"_fogTop",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1.5}}),Yt=u(Nt.prototype,"_fogRange",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1.2}}),u(Nt.prototype,"enabled",[Y],Object.getOwnPropertyDescriptor(Nt.prototype,"enabled"),Nt.prototype),u(Nt.prototype,"fogColor",[Y],Object.getOwnPropertyDescriptor(Nt.prototype,"fogColor"),Nt.prototype),u(Nt.prototype,"type",[Y,ut],Object.getOwnPropertyDescriptor(Nt.prototype,"type"),Nt.prototype),u(Nt.prototype,"fogDensity",[ct,ht,pt,ft,J,lt],Object.getOwnPropertyDescriptor(Nt.prototype,"fogDensity"),Nt.prototype),u(Nt.prototype,"fogStart",[_t,gt,dt,yt],Object.getOwnPropertyDescriptor(Nt.prototype,"fogStart"),Nt.prototype),u(Nt.prototype,"fogEnd",[bt,vt,mt,wt],Object.getOwnPropertyDescriptor(Nt.prototype,"fogEnd"),Nt.prototype),u(Nt.prototype,"fogAtten",[It,Tt,Et,kt,Ot],Object.getOwnPropertyDescriptor(Nt.prototype,"fogAtten"),Nt.prototype),u(Nt.prototype,"fogTop",[St,Ct,Lt,xt],Object.getOwnPropertyDescriptor(Nt.prototype,"fogTop"),Nt.prototype),u(Nt.prototype,"fogRange",[Pt,Bt,At,zt],Object.getOwnPropertyDescriptor(Nt.prototype,"fogRange"),Nt.prototype),Rt=Nt))||Rt),hn=(Jt=o("cc.ShadowsInfo"),Xt=G(X),Kt=ne(),Qt=G(V),qt=ne(),$t=G(K),er=ne(),tr=G(Q),rr=ne(),nr=G(V),ir=ne(),or=G(q),sr=ne(),ar=G(q),ur=ne(),cr=G(q),hr=ne(),pr=G(V),fr=ne(),lr=G(q),_r=ne(),gr=G(V),dr=ne(),yr=G(V),br=ne(),vr=G(V),mr=ne(),wr=ne(),Ir=G(V),Tr=ne(),Jt((Vr=function(){function e(){$(this,"_type",Or,this),$(this,"_enabled",Sr,this),$(this,"_normal",Cr,this),$(this,"_distance",Lr,this),$(this,"_shadowColor",xr,this),$(this,"_autoAdapt",Pr,this),$(this,"_pcf",Br,this),$(this,"_bias",Ar,this),$(this,"_packing",zr,this),$(this,"_linear",Rr,this),$(this,"_selfShadow",Nr,this),$(this,"_normalBias",Dr,this),$(this,"_near",jr,this),$(this,"_far",Mr,this),$(this,"_aspect",Fr,this),$(this,"_orthoSize",Ur,this),$(this,"_maxReceived",Hr,this),$(this,"_size",Gr,this),this._resource=null}var t=e.prototype;return t.setPlaneFromNode=function(e){e.getWorldRotation(sn),this.normal=L.transformQuat(on,nn,sn),e.getWorldPosition(on),this.distance=L.dot(this._normal,on)},t.activate=function(e){this._resource=e,this._resource.initialize(this),this._resource.activate()},a(e,[{key:"enabled",get:function(){return this._enabled},set:function(e){this._enabled!==e&&(this._enabled=e,this._resource&&(this._resource.enabled=e,e&&(this._resource.type=this._type)))}},{key:"type",get:function(){return this._type},set:function(e){this._type=e,this._resource&&(this._resource.type=e)}},{key:"shadowColor",get:function(){return this._shadowColor},set:function(e){this._shadowColor.set(e),this._resource&&(this._resource.shadowColor=e)}},{key:"normal",get:function(){return this._normal},set:function(e){L.copy(this._normal,e),this._resource&&(this._resource.normal=e)}},{key:"distance",get:function(){return this._distance},set:function(e){this._distance=e,this._resource&&(this._resource.distance=e)}},{key:"pcf",get:function(){return this._pcf},set:function(e){this._pcf=e,this._resource&&(this._resource.pcf=e)}},{key:"maxReceived",get:function(){return this._maxReceived},set:function(e){this._maxReceived=e,this._resource&&(this._resource.maxReceived=e)}},{key:"bias",get:function(){return this._bias},set:function(e){this._bias=e,this._resource&&(this._resource.bias=e)}},{key:"packing",get:function(){return this._packing},set:function(e){this._packing=e,e&&(this._linear=!this._linear&&this._linear,this._resource&&(this._resource.linear=this._linear)),this._resource&&(this._resource.packing=e,this._resource.shadowMapDirty=!0)}},{key:"linear",get:function(){return this._linear},set:function(e){this._linear=e,e&&(this._packing=!this._packing&&this._packing,this._resource&&(this._resource.packing=this._packing)),this._resource&&(this._resource.linear=e)}},{key:"selfShadow",get:function(){return this._selfShadow},set:function(e){this._selfShadow=e,this._resource&&(this._resource.selfShadow=e)}},{key:"normalBias",get:function(){return this._normalBias},set:function(e){this._normalBias=e,this._resource&&(this._resource.normalBias=e)}},{key:"autoAdapt",get:function(){return this._autoAdapt},set:function(e){this._autoAdapt=e,this._resource&&(this._resource.autoAdapt=e)}},{key:"near",get:function(){return this._near},set:function(e){this._near=e,this._resource&&(this._resource.near=e)}},{key:"far",get:function(){return this._far},set:function(e){this._far=e,this._resource&&(this._resource.far=e)}},{key:"orthoSize",get:function(){return this._orthoSize},set:function(e){this._orthoSize=e,this._resource&&(this._resource.orthoSize=e)}},{key:"shadowMapSize",get:function(){return this._size},set:function(e){this._size.set(e),this._resource&&(this._resource.size=e,this._resource.shadowMapDirty=!0)}},{key:"aspect",get:function(){return this._aspect},set:function(e){this._aspect=e,this._resource&&(this._resource.aspect=e)}}]),e}(),Or=u((kr=Vr).prototype,"_type",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return X.Planar}}),Sr=u(kr.prototype,"_enabled",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Cr=u(kr.prototype,"_normal",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new L(0,1,0)}}),Lr=u(kr.prototype,"_distance",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),xr=u(kr.prototype,"_shadowColor",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ee(0,0,0,76)}}),Pr=u(kr.prototype,"_autoAdapt",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Br=u(kr.prototype,"_pcf",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return K.HARD}}),Ar=u(kr.prototype,"_bias",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1e-5}}),zr=u(kr.prototype,"_packing",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Rr=u(kr.prototype,"_linear",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Nr=u(kr.prototype,"_selfShadow",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Dr=u(kr.prototype,"_normalBias",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),jr=u(kr.prototype,"_near",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Mr=u(kr.prototype,"_far",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 30}}),Fr=u(kr.prototype,"_aspect",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Ur=u(kr.prototype,"_orthoSize",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),Hr=u(kr.prototype,"_maxReceived",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 4}}),Gr=u(kr.prototype,"_size",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new P(512,512)}}),u(kr.prototype,"enabled",[Y],Object.getOwnPropertyDescriptor(kr.prototype,"enabled"),kr.prototype),u(kr.prototype,"type",[Y,Xt],Object.getOwnPropertyDescriptor(kr.prototype,"type"),kr.prototype),u(kr.prototype,"shadowColor",[Y],Object.getOwnPropertyDescriptor(kr.prototype,"shadowColor"),kr.prototype),u(kr.prototype,"normal",[Kt],Object.getOwnPropertyDescriptor(kr.prototype,"normal"),kr.prototype),u(kr.prototype,"distance",[Qt,qt],Object.getOwnPropertyDescriptor(kr.prototype,"distance"),kr.prototype),u(kr.prototype,"pcf",[$t,er],Object.getOwnPropertyDescriptor(kr.prototype,"pcf"),kr.prototype),u(kr.prototype,"maxReceived",[tr,rr],Object.getOwnPropertyDescriptor(kr.prototype,"maxReceived"),kr.prototype),u(kr.prototype,"bias",[nr,ir],Object.getOwnPropertyDescriptor(kr.prototype,"bias"),kr.prototype),u(kr.prototype,"packing",[or,sr],Object.getOwnPropertyDescriptor(kr.prototype,"packing"),kr.prototype),u(kr.prototype,"linear",[ar,ur],Object.getOwnPropertyDescriptor(kr.prototype,"linear"),kr.prototype),u(kr.prototype,"selfShadow",[cr,hr],Object.getOwnPropertyDescriptor(kr.prototype,"selfShadow"),kr.prototype),u(kr.prototype,"normalBias",[pr,fr],Object.getOwnPropertyDescriptor(kr.prototype,"normalBias"),kr.prototype),u(kr.prototype,"autoAdapt",[lr,_r],Object.getOwnPropertyDescriptor(kr.prototype,"autoAdapt"),kr.prototype),u(kr.prototype,"near",[gr,dr],Object.getOwnPropertyDescriptor(kr.prototype,"near"),kr.prototype),u(kr.prototype,"far",[yr,br],Object.getOwnPropertyDescriptor(kr.prototype,"far"),kr.prototype),u(kr.prototype,"orthoSize",[vr,mr],Object.getOwnPropertyDescriptor(kr.prototype,"orthoSize"),kr.prototype),u(kr.prototype,"shadowMapSize",[wr],Object.getOwnPropertyDescriptor(kr.prototype,"shadowMapSize"),kr.prototype),u(kr.prototype,"aspect",[Ir,Tr],Object.getOwnPropertyDescriptor(kr.prototype,"aspect"),kr.prototype),Er=kr))||Er);h.ShadowsInfo=hn;var pn,fn,ln,_n,gn,dn=(Yr=o("cc.SceneGlobals"),Wr=G(un),Yr(($r=function(){function e(){$(this,"ambient",Xr,this),$(this,"shadows",Kr,this),$(this,"_skybox",Qr,this),$(this,"fog",qr,this)}return e.prototype.activate=function(){var e=h.director.root.pipeline.pipelineSceneData;this.ambient.activate(e.ambient),this.skybox.activate(e.skybox),this.shadows.activate(e.shadows),this.fog.activate(e.fog)},a(e,[{key:"skybox",get:function(){return this._skybox},set:function(e){this._skybox=e}}]),e}(),Xr=u((Jr=$r).prototype,"ambient",[te,Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new an}}),Kr=u(Jr.prototype,"shadows",[te,Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new hn}}),Qr=u(Jr.prototype,"_skybox",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new un}}),qr=u(Jr.prototype,"fog",[Y,te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new cn}}),u(Jr.prototype,"skybox",[Y,Wr],Object.getOwnPropertyDescriptor(Jr.prototype,"skybox"),Jr.prototype),Zr=Jr))||Zr);h.SceneGlobals=dn;var yn=e("a",o("cc.Scene")((gn=function(e){s(r,e);var t=r.prototype;function r(t){var r;return r=e.call(this,t)||this,$(r,"autoReleaseAssets",ln,fe(r)),$(r,"_globals",_n,fe(r)),r._renderScene=null,r.dependAssets=null,r._inited=void 0,r._prefabSyncedInLiveReload=!1,r._pos=L.ZERO,r._rot=H.IDENTITY,r._scale=L.ONE,r._mat=he.IDENTITY,r._dirtyFlags=0,r._activeInHierarchy=!1,h.director&&h.director.root&&(r._renderScene=h.director.root.createScene({})),r._inited=!h.game||!h.game._isCloning,r}return t._updateScene=function(){this._scene=this},t.destroy=function(){var e=F.prototype.destroy.call(this);if(e)for(var t=this._children,r=0;r<t.length;++r)t[r].active=!1;return h.director.root.destroyScene(this._renderScene),this._active=!1,this._activeInHierarchy=!1,e},t.addComponent=function(){throw new Error(ue(3822))},t._onHierarchyChanged=function(){},t._onBatchCreated=function(t){e.prototype._onBatchCreated.call(this,t);for(var r=this._children.length,n=0;n<r;++n)this.children[n]._siblingIndex=n,this._children[n]._onBatchCreated(t);ce(this)},t.getPosition=function(e){return L.copy(e||new L,L.ZERO)},t.getRotation=function(e){return H.copy(e||new H,H.IDENTITY)},t.getScale=function(e){return L.copy(e||new L,L.ONE)},t.getWorldPosition=function(e){return L.copy(e||new L,L.ZERO)},t.getWorldRotation=function(e){return H.copy(e||new H,H.IDENTITY)},t.getWorldScale=function(e){return L.copy(e||new L,L.ONE)},t.getWorldMatrix=function(e){return he.copy(e||new he,he.IDENTITY)},t.getWorldRS=function(e){return he.copy(e||new he,he.IDENTITY)},t.getWorldRT=function(e){return he.copy(e||new he,he.IDENTITY)},t.updateWorldTransform=function(){},t._instantiate=function(){},t._load=function(){this._inited||(this._onBatchCreated(pe),this._inited=!0),this.walk(D._setScene)},t._activate=function(e){e=!1!==e,h.director._nodeActivator.activateNode(this,e),this._globals.activate()},a(r,[{key:"renderScene",get:function(){return this._renderScene}},{key:"globals",get:function(){return this._globals}},{key:"position",get:function(){return L.ZERO}},{key:"worldPosition",get:function(){return L.ZERO}},{key:"rotation",get:function(){return H.IDENTITY}},{key:"worldRotation",get:function(){return H.IDENTITY}},{key:"scale",get:function(){return L.ONE}},{key:"worldScale",get:function(){return L.ONE}},{key:"eulerAngles",get:function(){return L.ZERO}},{key:"worldMatrix",get:function(){return he.IDENTITY}}]),r}(D),u((fn=gn).prototype,"globals",[Y],Object.getOwnPropertyDescriptor(fn.prototype,"globals"),fn.prototype),ln=u(fn.prototype,"autoReleaseAssets",[te,Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_n=u(fn.prototype,"_globals",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new dn}}),pn=fn))||pn);function bn(e,t){if(!t){var r=h.director.getScene();if(!r)return null;t=r}return t.getChildByPath(e)}h.Scene=yn,h.find=bn;var vn=le.fastRemoveAt,mn=F.Flags.IsStartCalled,wn=F.Flags.IsOnEnableCalled;function In(e,t){for(var r=t.constructor._executionOrder,n=t._id,i=0,o=e.length-1,s=o>>>1;i<=o;s=i+o>>>1){var a=e[s],u=a.constructor._executionOrder;if(u>r)o=s-1;else if(u<r)i=s+1;else{var c=a._id;if(c>n)o=s-1;else{if(!(c<n))return s;i=s+1}}}return~i}function Tn(e,t){for(var r=e.array,n=e.i+1;n<r.length;){var i=r[n];i.node._activeInHierarchy?++n:(e.removeAt(n),t&&(i._objFlags&=~t))}}F.Flags.IsEditorOnEnableCalled;var En=function(e){this._zero=void 0,this._neg=void 0,this._pos=void 0,this._invoke=void 0;var t=_e;this._zero=new t([]),this._neg=new t([]),this._pos=new t([]),this._invoke=e};function kn(e,t){return e.constructor._executionOrder-t.constructor._executionOrder}En.stableRemoveInactive=Tn;var On=function(e){function t(){return e.apply(this,arguments)||this}s(t,e);var r=t.prototype;return r.add=function(e){var t=e.constructor._executionOrder;(0===t?this._zero:t<0?this._neg:this._pos).array.push(e)},r.remove=function(e){var t=e.constructor._executionOrder;(0===t?this._zero:t<0?this._neg:this._pos).fastRemove(e)},r.cancelInactive=function(e){Tn(this._zero,e),Tn(this._neg,e),Tn(this._pos,e)},r.invoke=function(){var e=this._neg;e.array.length>0&&(e.array.sort(kn),this._invoke(e),e.array.length=0),this._invoke(this._zero),this._zero.array.length=0;var t=this._pos;t.array.length>0&&(t.array.sort(kn),this._invoke(t),t.array.length=0)},t}(En),Sn=function(e){function t(){return e.apply(this,arguments)||this}s(t,e);var r=t.prototype;return r.add=function(e){var t=e.constructor._executionOrder;if(0===t)this._zero.array.push(e);else{var r=t<0?this._neg.array:this._pos.array,n=In(r,e);n<0&&r.splice(~n,0,e)}},r.remove=function(e){var t=e.constructor._executionOrder;if(0===t)this._zero.fastRemove(e);else{var r=t<0?this._neg:this._pos,n=In(r.array,e);n>=0&&r.removeAt(n)}},r.invoke=function(e){this._neg.array.length>0&&this._invoke(this._neg,e),this._invoke(this._zero,e),this._pos.array.length>0&&this._invoke(this._pos,e)},t}(En);function Cn(e,t,r){return function(n,i){try{t(n,i)}catch(t){h._throw(t);var o=n.array;for(r&&(o[n.i]._objFlags|=r),++n.i;n.i<o.length;++n.i)try{e(o[n.i],i)}catch(e){h._throw(e),r&&(o[n.i]._objFlags|=r)}}}}var Ln=Cn((function(e){e.start(),e._objFlags|=mn}),(function(e){var t=e.array;for(e.i=0;e.i<t.length;++e.i){var r=t[e.i];r.start(),r._objFlags|=mn}}),mn),xn=Cn((function(e,t){e.update(t)}),(function(e,t){var r=e.array;for(e.i=0;e.i<r.length;++e.i)r[e.i].update(t)})),Pn=Cn((function(e,t){e.lateUpdate(t)}),(function(e,t){var r=e.array;for(e.i=0;e.i<r.length;++e.i)r[e.i].lateUpdate(t)})),Bn=function(e){var t=h.director._compScheduler,r=e.array;for(e.i=0;e.i<r.length;++e.i){var n=r[e.i];n._enabled&&(n.onEnable(),!n.node._activeInHierarchy||t._onEnabled(n))}},An=(e("C",function(){function e(){this._deferredComps=[],this.unscheduleAll()}var t=e.prototype;return t.unscheduleAll=function(){this.startInvoker=new On(Ln),this.updateInvoker=new Sn(xn),this.lateUpdateInvoker=new Sn(Pn),this._updating=!1},t._onEnabled=function(e){h.director.getScheduler().resumeTarget(e),e._objFlags|=wn,this._updating?this._deferredComps.push(e):this._scheduleImmediate(e)},t._onDisabled=function(e){h.director.getScheduler().pauseTarget(e),e._objFlags&=~wn;var t=this._deferredComps.indexOf(e);t>=0?vn(this._deferredComps,t):(!e.start||e._objFlags&mn||this.startInvoker.remove(e),e.update&&this.updateInvoker.remove(e),e.lateUpdate&&this.lateUpdateInvoker.remove(e))},t.enableComp=function(e,t){if(!(e._objFlags&wn)){if(e.onEnable){if(t)return void t.add(e);if(e.onEnable(),!e.node._activeInHierarchy)return}this._onEnabled(e)}},t.disableComp=function(e){e._objFlags&wn&&(e.onDisable&&e.onDisable(),this._onDisabled(e))},t.startPhase=function(){this._updating=!0,this.startInvoker.invoke(),this._startForNewComps()},t.updatePhase=function(e){this.updateInvoker.invoke(e)},t.lateUpdatePhase=function(e){this.lateUpdateInvoker.invoke(e),this._updating=!1,this._startForNewComps()},t._startForNewComps=function(){this._deferredComps.length>0&&(this._deferredSchedule(),this.startInvoker.invoke())},t._scheduleImmediate=function(e){"function"!=typeof e.start||e._objFlags&mn||this.startInvoker.add(e),"function"==typeof e.update&&this.updateInvoker.add(e),"function"==typeof e.lateUpdate&&this.lateUpdateInvoker.add(e)},t._deferredSchedule=function(){for(var e=this._deferredComps,t=0,r=e.length;t<r;t++)this._scheduleImmediate(e[t]);e.length=0},e}()),F.Flags.IsPreloadStarted),zn=F.Flags.IsOnLoadStarted,Rn=F.Flags.IsOnLoadCalled,Nn=F.Flags.Deactivating,Dn=function(e){function t(){return e.apply(this,arguments)||this}s(t,e);var r=t.prototype;return r.add=function(e){this._zero.array.push(e)},r.remove=function(e){this._zero.fastRemove(e)},r.cancelInactive=function(e){En.stableRemoveInactive(this._zero,e)},r.invoke=function(){this._invoke(this._zero),this._zero.array.length=0},t}(En),jn=Cn((function(e){e.__preload()}),(function(e){var t=e.array;for(e.i=0;e.i<t.length;++e.i)t[e.i].__preload()})),Mn=Cn((function(e){e.onLoad(),e._objFlags|=Rn}),(function(e){var t=e.array;for(e.i=0;e.i<t.length;++e.i){var r=t[e.i];r.onLoad(),r._objFlags|=Rn}}),Rn),Fn=new ge(4);function Un(e,t,r){t?e._removeComponent(t):le.removeAt(e._components,r)}Fn.get=function(){var e=this._get()||{preload:new Dn(jn),onLoad:new On(Mn),onEnable:new On(Bn)};e.preload._zero.i=-1;var t=e.onLoad;return t._zero.i=-1,t._neg.i=-1,t._pos.i=-1,(t=e.onEnable)._zero.i=-1,t._neg.i=-1,t._pos.i=-1,e},e("N",function(){function e(){this.resetComp=void 0,this.reset()}var t=e.prototype;return t.reset=function(){this._activatingStack=[]},t.activateNode=function(e,t){if(t){var r=Fn.get();this._activatingStack.push(r),this._activateNodeRecursively(e,r.preload,r.onLoad,r.onEnable),r.preload.invoke(),r.onLoad.invoke(),r.onEnable.invoke(),this._activatingStack.pop(),Fn.put(r)}else{this._deactivateNodeRecursively(e);for(var n,i=this._activatingStack,o=de(i);!(n=o()).done;){var s=n.value;s.preload.cancelInactive(An),s.onLoad.cancelInactive(zn),s.onEnable.cancelInactive()}}e.emit("active-in-hierarchy-changed",e)},t.activateComp=function(e,t,r,n){if(ye(e,!0)&&(e._objFlags&An||(e._objFlags|=An,e.__preload&&(t?t.add(e):e.__preload())),e._objFlags&zn||(e._objFlags|=zn,e.onLoad?r?r.add(e):(e.onLoad(),e._objFlags|=Rn):e._objFlags|=Rn),e._enabled)){if(!e.node._activeInHierarchy)return;h.director._compScheduler.enableComp(e,n)}},t.destroyComp=function(e){h.director._compScheduler.disableComp(e),e.onDestroy&&e._objFlags&Rn&&e.onDestroy()},t._activateNodeRecursively=function(e,t,r,n){if(e._objFlags&Nn)R(3816,e.name);else{e._activeInHierarchy=!0;for(var i=e._components.length,o=0;o<i;++o){var s=e._components[o];s instanceof h.Component?this.activateComp(s,t,r,n):(Un(e,s,o),--o,--i)}e._childArrivalOrder=e._children.length;for(var a=0,u=e._children.length;a<u;++a){var c=e._children[a];c._active&&this._activateNodeRecursively(c,t,r,n)}e._onPostActivated(!0)}},t._deactivateNodeRecursively=function(e){e._objFlags|=Nn,e._activeInHierarchy=!1;for(var t=e._components.length,r=0;r<t;++r){var n=e._components[r];if(n._enabled&&(h.director._compScheduler.disableComp(n),e._activeInHierarchy))return void(e._objFlags&=~Nn)}for(var i=0,o=e._children.length;i<o;++i){var s=e._children[i];if(s._activeInHierarchy&&(this._deactivateNodeRecursively(s),e._activeInHierarchy))return void(e._objFlags&=~Nn)}e._onPostActivated(!1),e._objFlags&=~Nn},e}());var Hn,Gn,Vn,Yn,Wn,Zn,Jn,Xn,Kn=e("S",o("cc.SceneAsset")((Yn=function(e){function t(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return t=e.call.apply(e,[this].concat(n))||this,$(t,"scene",Vn,fe(t)),t}s(t,e);var r=t.prototype;return r.initDefault=function(t){e.prototype.initDefault.call(this,t),this.scene=new yn("New Scene")},r.validate=function(){return!!this.scene},t}(p),Vn=u((Gn=Yn).prototype,"scene",[Y,te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Hn=Gn))||Hn);h.SceneAsset=Kn;var Qn,qn,$n,ei,ti=e("T",o("cc.TextAsset")((Xn=function(e){function t(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return t=e.call.apply(e,[this].concat(n))||this,$(t,"text",Jn,fe(t)),t}return s(t,e),t.prototype.toString=function(){return this.text},t}(p),Jn=u((Zn=Xn).prototype,"text",[te,Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Wn=Zn))||Wn);h.TextAsset=ti;var ri=e("J",o("cc.JsonAsset")((ei=function(e){function t(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return t=e.call.apply(e,[this].concat(n))||this,$(t,"json",$n,fe(t)),t}return s(t,e),t}(p),$n=u((qn=ei).prototype,"json",[te,Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Qn=qn))||Qn);h.JsonAsset=ri}}}));
